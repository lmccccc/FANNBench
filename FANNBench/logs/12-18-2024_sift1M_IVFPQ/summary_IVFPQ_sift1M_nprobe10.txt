Start time: 05:28
====================
START: running IVFPQ_INDEX_CONSTRUCTION, sift data --

dataset: sift1M
N: 1000000
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
index file: /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64
dim: 128
partition_size: 64
train file: /mnt/data/mocheng/dataset/sift/sift_learn.fvecs
 bytes_per_vec: 2.000
loaded base attributes, size:1000000
[ 0.022s ] Loaded attributions, 1000000 found
[ 0.022s ] Index Params -- d: 128, N: 1000000
====================Vectors====================

[ 0.022s ] Loading database
[ 0.381s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
data loaded, with dim: 128, N=1000000
[ 0.381s ] Indexing database, size 1000000*128 from max 1000000
[ 0.381s ] Adding the vectors to the index
train cost:0.359
index construction total cost:180.660
[ 180.660s ] Vectors added to  index
Index vectors added:1000000
====================Write Index================

[ 181.086s ] Wrote ivbfpq index to file: /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64
[181.086 s] -----DONE-----
[ 181.086s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_build sift1M 1000000 10 128 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64 128 64 /mnt/data/mocheng/dataset/sift/sift_learn.fvecs"
	User time (seconds): 16050.61
	System time (seconds): 22.17
	Percent of CPU this job got: 8872%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 3:01.14
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 1122472
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 12
	Minor (reclaiming a frame) page faults: 1904408
	Voluntary context switches: 1405930
	Involuntary context switches: 115401
	Swaps: 0
	File system inputs: 12648
	File system outputs: 23872
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:37
====================
START: running TEST_IVFPQ, sift data --

dataset: sift1M
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
query file: /mnt/data/mocheng/dataset/sift/sift_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
qrange file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json
gt file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json
index file: /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64
nprobe: 10
dim: 128
loaded base attributes from:/mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
[ 0.022s ] Loaded metadata, 1000000 attr's found
[ 0.022s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 0.025s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift/sift_query.fvecs
[ 0.027s ] Loaded 10000 sift1M queries
[ 0.035s ] Loaded ground truth, gt_size: 10
[ 0.035s ] Index Params -- d: 128, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 0.069s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.000
[ 7.486s ] Query results (vector ids, then distances):
query 0 nn's (1, 1): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (1, 1): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (1, 1): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (1, 1): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (1, 1): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
[ 7.486s ] *** Query time: 1.320
qps: 7573.928
 *** ivfpq recall 
ivfpq get 0 postive res from 100000 results, recall@10:0.000
recall dist(10% per bucket): 1.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
finished ivfpq index examples
[ 7.486s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query sift1M 1000000 10 1 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sift_query.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64 10 128"
	User time (seconds): 7.46
	System time (seconds): 0.03
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:07.49
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 44964
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 9921
	Voluntary context switches: 1
	Involuntary context switches: 28
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:44
====================
START: running TEST_IVFPQ, sift data --

dataset: sift1M
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
query file: /mnt/data/mocheng/dataset/sift/sift_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
qrange file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json
gt file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json
index file: /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64
nprobe: 10
dim: 128
label example: 
0 
1 
0 7 
3 
0 5 
0 5 
2 4 5 
1 
0 
0 
loaded base attributes from:/mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
[ 1.340s ] Loaded metadata, 1000000 attr's found
[ 1.340s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.344s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift/sift_query.fvecs
[ 1.345s ] Loaded 10000 sift1M queries
[ 1.352s ] Loaded ground truth, gt_size: 10
[ 1.352s ] Index Params -- d: 128, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 1.385s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.270
[ 427.041s ] Query results (vector ids, then distances):
query 0 nn's (1, 1): 731216 (1) 436743 (1) 465294 (1, 6) 403442 (1, 3) 213779 (1) 727283 (1) 974147 (0, 1) 839632 (0, 1) 876511 (1) 988628 (1) 
     dis: 	50592.953 57408.539 57975.367 59029.172 59612.258 60615.090 62657.438 63732.891 63923.547 64858.445 
query 1 nn's (1, 1): 880462 (0, 1) 481051 (1) 254702 (0, 1, 2) 103069 (0, 1) 682723 (1, 4) 898583 (0, 1, 6) 174840 (0, 1, 6) 743982 (0, 1) 714851 (1) 208739 (0, 1) 
     dis: 	42799.086 44051.828 46368.434 46974.246 47839.059 49462.949 50240.160 50807.406 51382.203 51643.969 
query 2 nn's (1, 1): 772134 (0, 1) 133557 (1) 61501 (1, 2) 408855 (0, 1) 408462 (1) 516925 (0, 1) 736302 (0, 1) 2707 (1, 5) 418312 (0, 1) 723487 (1) 
     dis: 	25746.906 28156.014 29452.320 30817.625 31227.820 32506.211 33339.250 34188.016 34345.805 34887.824 
query 3 nn's (1, 1): 545314 (1, 3) 781761 (0, 1, 2) 249140 (0, 1) 191092 (0, 1) 847176 (1) 959273 (0, 1) 883489 (1) 191660 (0, 1) 863579 (1) 853841 (1) 
     dis: 	27589.078 28340.877 28658.854 31646.494 34845.324 35521.789 35693.430 36551.312 36739.824 37041.480 
query 4 nn's (1, 1): 106921 (1) 46782 (0, 1) 34537 (1) 184326 (1, 5) 353254 (1, 4) 353246 (1, 5) 259196 (1) 549359 (0, 1) 410889 (0, 1, 6) 748900 (0, 1) 
     dis: 	45242.914 45365.867 50506.934 50951.641 51386.512 51472.289 53131.859 53251.215 53410.398 54057.402 
[ 427.042s ] *** Query time: 120.029
qps: 83.313
 *** ivfpq recall 
ivfpq get 20951 postive res from 100000 results, recall@10:0.210
recall dist(10% per bucket): 0.129 0.248 0.273 0.188 0.098 0.042 0.016 0.004 0.001 0.000 0.000 
finished ivfpq index examples
[ 427.043s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_keyword sift1M 1000000 10 1 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sift_query.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json /mnt/data/mocheng/dataset/sift/ivfpq/index/index_ivfpq_sel_1_8_8_random_64 10 128"
	User time (seconds): 367.51
	System time (seconds): 66.48
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 7:14.04
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 132422532
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 34151738
	Voluntary context switches: 1
	Involuntary context switches: 1273
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
