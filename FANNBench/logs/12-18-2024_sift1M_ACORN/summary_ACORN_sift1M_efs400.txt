Start time: 01:10
====================
START: running ACORN_INDEX_CONSTRUCTION for hnsw, sift data --

dataset: sift1M
N: 1000000
gamma: 12
M: 40
M_beta: 64
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
index file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
dim: 128
terminate called after throwing an instance of 'nlohmann::detail::type_error'
  what():  [json.exception.type_error.302] type must be number, but is array
Command terminated by signal 6
	Command being timed: "../ACORN/build/demos/acorn_build sift1M 1000000 12 40 64 10 128 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64 128"
	User time (seconds): 0.19
	System time (seconds): 0.05
	Percent of CPU this job got: 17%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:01.36
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 94800
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 4
	Minor (reclaiming a frame) page faults: 25914
	Voluntary context switches: 8
	Involuntary context switches: 2
	Swaps: 0
	File system inputs: 3184
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:07
====================
START: running ACORN_INDEX_CONSTRUCTION for hnsw, sift data --

dataset: sift1M
N: 1000000
gamma: 12
M: 40
M_beta: 64
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
index file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
dim: 128
[ 0.000s ] Index Params -- d: 128, M: 40, N: 1000000, gamma: 12
--ACORN index created
====================Vectors====================

[ 0.000s ] Loading database
[ 0.323s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
data loaded, with dim: 128, nb=1000000
[ 0.323s ] Indexing database, size 1000000*128 from max 1000000
[ 0.323s ] Adding the vectors to the index
adding to storage
storage added
max_level: 4
Adding 1 elements at level 4
Adding 15 elements at level 3
Command terminated by signal 11
	Command being timed: "../ACORN/build/demos/acorn_build sift1M 1000000 12 40 64 10 128 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64 128"
	User time (seconds): 0.33
	System time (seconds): 1.15
	Percent of CPU this job got: 57%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:02.60
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2036072
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 640618
	Voluntary context switches: 3
	Involuntary context switches: 2
	Swaps: 0
	File system inputs: 0
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:07
====================
START: running ACORN_INDEX_CONSTRUCTION for hnsw, sift data --

dataset: sift1M
N: 1000000
gamma: 12
M: 40
M_beta: 64
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
index file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
dim: 128
[ 0.002s ] Index Params -- d: 128, M: 40, N: 1000000, gamma: 12
--ACORN index created
====================Vectors====================

[ 0.002s ] Loading database
[ 0.322s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
data loaded, with dim: 128, nb=1000000
[ 0.322s ] Indexing database, size 1000000*128 from max 1000000
[ 0.322s ] Adding the vectors to the index
adding to storage
storage added
max_level: 4
Adding 1 elements at level 4
Adding 15 elements at level 3
Adding 607 elements at level 2
Adding 24333 elements at level 1
Adding 975044 elements at level 0
[ 113.156s ] Vectors added to hybrid index1000000
Hybrid index vectors added:1000000
====================Write Index================

[ 113.939s ] Wrote hybrid index to file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 604
		indx 3: 1084
		indx 4: 1564
		indx 5: 2044
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 480
	* efSearch: 16
	* max_level: 4
	* entry_point: 118295
	* gamma: 12
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 1000000
   2. neighbors per node: 86.66 (86656009)
   3. nb of reciprocal neighbors: 59.89
   4. nb of neighbors that are also neighbor-of-neighbors: 84.72 (84715190)
========= LEVEL 1 =======
* stats on level 1, max 480 neighbors per vertex:
   1. nb of nodes: 24956
   2. neighbors per node: 480.00 (11978880)
   3. nb of reciprocal neighbors: 76.91
   4. nb of neighbors that are also neighbor-of-neighbors: 399.99 (9982036)
========= LEVEL 2 =======
* stats on level 2, max 480 neighbors per vertex:
   1. nb of nodes: 623
   2. neighbors per node: 468.94 (292148)
   3. nb of reciprocal neighbors: 430.92
   4. nb of neighbors that are also neighbor-of-neighbors: 468.41 (291821)
========= LEVEL 3 =======
* stats on level 3, max 480 neighbors per vertex:
   1. nb of nodes: 16
   2. neighbors per node: 15.00 (240)
   3. nb of reciprocal neighbors: 13.12
   4. nb of neighbors that are also neighbor-of-neighbors: 14.31 (229)
========= LEVEL 4 =======
* stats on level 4, max 480 neighbors per vertex:
   1. nb of nodes: 1
   2. neighbors per node: 0.00 (0)
   3. nb of reciprocal neighbors: 0.00
   4. nb of neighbors that are also neighbor-of-neighbors: 0.00 (0)
METADATA VEC for number nodes per level
	level 0: 999896 nodes
	level 1: 24956 nodes
	level 2: 623 nodes
	level 3: 16 nodes
	level 4: 1 nodes
	level 5: 0 nodes
acorn size: 545144320, memory: 1019.615MB
[116.140 s] -----DONE-----
[ 116.140s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_build sift1M 1000000 12 40 64 10 128 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64 128"
	User time (seconds): 13211.26
	System time (seconds): 20.47
	Percent of CPU this job got: 11382%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:56.24
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2039984
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 2145486
	Voluntary context switches: 21801
	Involuntary context switches: 296722
	Swaps: 0
	File system inputs: 168
	File system outputs: 2088208
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:13
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift1M
N: 1000000
gamma: 12
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
query file: /mnt/data/mocheng/dataset/sift/sift_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
qrange file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json
gt file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json
index file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
ef_search: 400 
dim: 128
terminate called after throwing an instance of 'nlohmann::detail::type_error'
  what():  [json.exception.type_error.302] type must be number, but is array
Command terminated by signal 6
	Command being timed: "../ACORN/build/demos/acorn_query sift1M 1000000 12 40 64 10 1 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sift_query.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64 400 128"
	User time (seconds): 0.18
	System time (seconds): 0.05
	Percent of CPU this job got: 17%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:01.36
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 94804
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1
	Minor (reclaiming a frame) page faults: 25910
	Voluntary context switches: 5
	Involuntary context switches: 1
	Swaps: 0
	File system inputs: 352
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:19
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift1M
N: 1000000
gamma: 12
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift/sift_base.fvecs
query file: /mnt/data/mocheng/dataset/sift/sift_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
qrange file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json
gt file: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json
index file: /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64
ef_search: 400 
dim: 128
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json
[ 0.357s ] Loaded metadata, 1000000 attr's found
[ 0.357s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 0.388s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift/sift_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json
[ 0.390s ] Loaded 10000 sift1M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json
[ 0.399s ] Loaded ground truth, gt_size: 10
[ 0.399s ] Index Params -- d: 128, M: 40, N: 1000000, gamma: 12
--ACORN index created
acorn size: 545144320, memory: 1019.615MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 604
		indx 3: 1084
		indx 4: 1564
		indx 5: 2044
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 480
	* efSearch: 16
	* max_level: 4
	* entry_point: 118295
	* gamma: 12
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 1000000
   2. neighbors per node: 86.66 (86656009)
   3. nb of reciprocal neighbors: 59.89
   4. nb of neighbors that are also neighbor-of-neighbors: 84.72 (84715190)
========= LEVEL 1 =======
* stats on level 1, max 480 neighbors per vertex:
   1. nb of nodes: 24956
   2. neighbors per node: 480.00 (11978880)
   3. nb of reciprocal neighbors: 76.91
   4. nb of neighbors that are also neighbor-of-neighbors: 399.99 (9982036)
========= LEVEL 2 =======
* stats on level 2, max 480 neighbors per vertex:
   1. nb of nodes: 623
   2. neighbors per node: 468.94 (292148)
   3. nb of reciprocal neighbors: 430.92
   4. nb of neighbors that are also neighbor-of-neighbors: 468.41 (291821)
========= LEVEL 3 =======
* stats on level 3, max 480 neighbors per vertex:
   1. nb of nodes: 16
   2. neighbors per node: 15.00 (240)
   3. nb of reciprocal neighbors: 13.12
   4. nb of neighbors that are also neighbor-of-neighbors: 14.31 (229)
========= LEVEL 4 =======
* stats on level 4, max 480 neighbors per vertex:
   1. nb of nodes: 1
   2. neighbors per node: 0.00 (0)
   3. nb of reciprocal neighbors: 0.00
   4. nb of neighbors that are also neighbor-of-neighbors: 0.00 (0)
METADATA VEC for number nodes per level
	level 0: 999896 nodes
	level 1: 24956 nodes
	level 2: 623 nodes
	level 3: 16 nodes
	level 4: 1 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 150.044s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 400
selectivity: 0.270
[ 199.606s ] Query results (vector ids, then distances):
query 0 nn's (1): 708177 (1) 435345 (0, 1) 872728 (1, 4, 5) 565419 (0, 1) 565814 (1) 910119 (1) 843384 (1, 5) 886630 (1) 68299 (0, 1, 3) 779712 (0, 1, 4) 
     dis: 	65260.000 68247.000 71861.000 75634.000 76051.000 77564.000 77588.000 77660.000 77917.000 78092.000 
query 1 nn's (1): 413247 (0, 1) 880592 (1, 2) 880462 (0, 1) 941776 (0, 1) 586780 (1, 3) 833054 (0, 1) 208391 (1) 976547 (1, 2) 71819 (1) 598353 (1, 2, 7) 
     dis: 	51187.000 54987.000 56396.000 57646.000 58246.000 58464.000 59679.000 61167.000 61982.000 63645.000 
query 2 nn's (1): 408462 (1) 408855 (0, 1) 551743 (1, 3, 7) 900097 (1, 2) 431595 (1) 62269 (1) 150588 (1) 736302 (0, 1) 695462 (1) 534822 (0, 1, 2) 
     dis: 	33608.000 34104.000 36325.000 38137.000 38236.000 39826.000 39984.000 40215.000 40907.000 41204.000 
query 3 nn's (1): 48044 (1) 190621 (1, 3, 4) 190587 (0, 1) 191092 (0, 1) 941084 (1) 839734 (0, 1) 545314 (1, 3) 956544 (1) 191169 (0, 1) 192051 (0, 1, 2) 
     dis: 	32777.000 38013.000 40086.000 40234.000 41374.000 41880.000 41933.000 42167.000 42168.000 42605.000 
query 4 nn's (1): 368246 (0, 1, 4) 340288 (0, 1) 953387 (1, 7) 491554 (1, 6) 807785 (1) 403978 (0, 1) 79424 (0, 1, 7) 59308 (0, 1) 549359 (0, 1) 151654 (1, 3) 
     dis: 	57046.000 57968.000 58065.000 58390.000 58908.000 59193.000 59956.000 60042.000 60779.000 61768.000 
[ 199.606s ] *** Query time: 44.438
qps: 225.031
 *** acorn recall 
efs:400
acorn get 99940 postive res from 100000 results, recall@10:0.999
recall dist(10% per bucket): 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.006 0.994 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[200.234s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 99009430
ndis: 0
nreorder: 0
average distance computations per query: 9900.943
[ 200.234s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query_keyword sift1M 1000000 12 40 64 10 1 /mnt/data/mocheng/dataset/sift/sift_base.fvecs /mnt/data/mocheng/dataset/sift/sift_query.fvecs /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/attr_sel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/qrangesel_1_8_8_random.json /mnt/data/mocheng/dataset/sift/sel_1_8_8_random/sif_gt_10.json /mnt/data/mocheng/dataset/sift/acorn/index/index_acorn_sel_1_8_8_random_M40_ga12_Mb64 400 128"
	User time (seconds): 194.12
	System time (seconds): 6.23
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 3:20.37
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 11463460
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 2880004
	Voluntary context switches: 1
	Involuntary context switches: 595
	Swaps: 0
	File system inputs: 0
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
