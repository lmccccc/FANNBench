Start time: 00:21
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: spacev10m
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/attr_sel_1_500_random.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/qrangesel_1_1_500_random_19.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/sif_gt_sel_1_1_500_random_19_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_500_random_M40_ga25_Mb64
ef_search: 200 
dim: 100
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/attr_sel_1_500_random.json
[ 1.034s ] Loaded metadata, 10000000 attr's found
[ 1.034s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 1.036s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/qrangesel_1_1_500_random_19.json
[ 1.038s ] Loaded 10000 spacev10m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/sif_gt_sel_1_1_500_random_19_10.json
[ 1.049s ] Loaded ground truth, gt_size: 10
[ 1.049s ] Index Params -- d: 100, M: 40, N: 10000000, gamma: 25
terminate called after throwing an instance of 'faiss::FaissException'
  what():  Error in faiss::FileIOReader::FileIOReader(const char*) at /home/mocheng/code/ACORN/faiss/impl/io.cpp:67: Error: 'f' failed: could not open /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_500_random_M40_ga25_Mb64 for reading: No such file or directory
Command terminated by signal 6
	Command being timed: "../ACORN/build/demos/acorn_query spacev10m 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/attr_sel_1_500_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/qrangesel_1_1_500_random_19.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random/sif_gt_sel_1_1_500_random_19_10.json /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_500_random_M40_ga25_Mb64 200 100"
	User time (seconds): 0.79
	System time (seconds): 0.26
	Percent of CPU this job got: 14%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:07.30
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 358952
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 13
	Minor (reclaiming a frame) page faults: 155814
	Voluntary context switches: 23
	Involuntary context switches: 4
	Swaps: 0
	File system inputs: 888
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 00:21
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: spacev10m
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/attr_sel_1_500_random_19.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/qrangesel_1_1_500_random_19.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/sif_gt_sel_1_1_500_random_19_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_500_random_19_M40_ga25_Mb64
ef_search: 200 
dim: 100
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/attr_sel_1_500_random_19.json
[ 1.026s ] Loaded metadata, 10000000 attr's found
[ 1.026s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 1.028s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/qrangesel_1_1_500_random_19.json
[ 1.030s ] Loaded 10000 spacev10m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/sif_gt_sel_1_1_500_random_19_10.json
[ 1.041s ] Loaded ground truth, gt_size: 10
[ 1.041s ] Index Params -- d: 100, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 9637.127MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 9999403 nodes
level 1 : 249957 nodes
level 2 : 6212 nodes
level 3 : 140 nodes
level 4 : 3 nodes
level 5 : 0 nodes
Total edge:10255715
Average degree per layer:1709285.833
node size:10000000
Average degree:149.631
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 22.428s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 200
selectivity: 0.010
[ 220.556s ] Query results (vector ids, then distances):
query 0 nn's (19): 9053999 (19) 2807977 (19) 3057373 (19) 3622412 (19) 5270820 (19) 9131976 (19) 3740591 (19) 8843034 (19) 2271622 (19) 7866226 (19) 
     dis: 	8650.000 8897.000 8918.000 9668.000 9676.000 10220.000 11285.000 11305.000 11321.000 11439.000 
query 1 nn's (19): 3843020 (19) 3255981 (19) 6716625 (19) 1386102 (19) 307231 (19) 2587018 (19) 1762221 (19) 6955583 (19) 1617045 (19) 8561106 (19) 
     dis: 	8685.000 9684.000 11253.000 11538.000 11622.000 11992.000 12240.000 12652.000 12932.000 13342.000 
query 2 nn's (19): 5236859 (19) 6688464 (19) 1386408 (19) 3436916 (19) 3641059 (19) 4465300 (19) 349510 (19) 2506689 (19) 8053598 (19) 8492702 (19) 
     dis: 	7538.000 8666.000 10729.000 11088.000 11256.000 11269.000 11429.000 11693.000 11881.000 12045.000 
query 3 nn's (19): 9100185 (19) 445803 (19) 1128854 (19) 2338828 (19) 2101314 (19) 2229532 (19) 5113097 (19) 2449912 (19) 67802 (19) 5958483 (19) 
     dis: 	10473.000 12481.000 13399.000 13723.000 14020.000 14174.000 14231.000 14551.000 14673.000 15121.000 
query 4 nn's (19): 5688541 (19) 7510113 (19) 8904857 (19) 5752111 (19) 9827236 (19) 8964274 (19) 2411654 (19) 6309716 (19) 7641188 (19) 5925120 (19) 
     dis: 	6846.000 7428.000 7907.000 7926.000 7939.000 7943.000 7945.000 8022.000 8043.000 8068.000 
[ 220.556s ] *** Query time: 63.677
qps: 157.042
 *** acorn recall 
efs:200
acorn get 85409 postive res from 100000 results, recall@10:0.854
recall dist(10% per bucket): 0.003 0.003 0.008 0.013 0.019 0.032 0.050 0.084 0.140 0.233 0.414 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[220.558s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 17335633
ndis: 0
nreorder: 0
average distance computations per query: 1733.563
[ 220.558s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query spacev10m 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/attr_sel_1_500_random_19.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/qrangesel_1_1_500_random_19.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_500_random_19/sif_gt_sel_1_1_500_random_19_10.json /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_500_random_19_M40_ga25_Mb64 200 100"
	User time (seconds): 200.19
	System time (seconds): 10.55
	Percent of CPU this job got: 95%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 3:41.29
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 15902392
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 4523781
	Voluntary context switches: 28622
	Involuntary context switches: 299
	Swaps: 0
	File system inputs: 1136136
	File system outputs: 32
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
