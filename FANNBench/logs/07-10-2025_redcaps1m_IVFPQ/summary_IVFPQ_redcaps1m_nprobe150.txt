Start time: 04:44
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 100
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_100.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_256
nprobe: 150
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.074s ] Loaded metadata, 1000000 attr's found
[ 0.074s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.085s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.087s ] Loaded 10000 redcaps1m queries
[ 0.154s ] Loaded ground truth, gt_size: 100
[ 0.154s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.055s ] Searching the 100 nearest neighbors of 10000 vectors in the index
selectivity: 0.500
[ 116.604s ] Query results (vector ids, then distances):
query 0 nn's (1540574211, 1590004802): 727106 (1557359735) 562528 (1586530455) 247269 (1563268918) 64073 (1552081912) 864174 (1586141206) 297407 (1562582134) 880422 (1565574478) 966838 (1570564531) 84548 (1557155880) 302187 (1566023840) 316095 (1551987403) 997247 (1547217917) 989732 (1576007752) 334544 (1563704708) 465841 (1541316839) 650558 (1552134375) 309200 (1583866074) 363324 (1588150617) 135244 (1573331572) 988753 (1543862249) 132358 (1558810217) 91712 (1562697586) 596166 (1579563279) 606467 (1568763473) 708925 (1576703816) 927993 (1565326081) 268357 (1575827166) 533175 (1575258274) 472918 (1564281975) 422643 (1556978810) 708700 (1541202222) 318225 (1582255095) 75346 (1564168304) 439788 (1565854244) 131965 (1556466636) 602879 (1548953318) 834158 (1542767236) 699054 (1579379170) 686231 (1566039123) 81228 (1560057467) 813377 (1544571766) 493307 (1561727055) 276583 (1587145061) 679931 (1540740143) 983152 (1550510814) 909887 (1573250307) 345358 (1552161794) 517669 (1549396737) 823706 (1585149377) 763265 (1542459164) 934902 (1582861469) 174023 (1555779163) 105541 (1553537809) 929021 (1555207103) 553713 (1584927669) 154883 (1581301418) 399187 (1587938124) 540453 (1573344926) 331521 (1564901683) 556864 (1565655760) 385435 (1589983348) 419559 (1588543049) 492624 (1552841438) 323370 (1580598904) 433231 (1565823839) 77303 (1588455303) 894678 (1585406115) 952583 (1550911908) 434594 (1551507970) 602404 (1541391641) 486165 (1570286389) 36195 (1542321827) 46879 (1559067774) 980277 (1581039128) 13080 (1541731484) 949111 (1587581586) 640854 (1565398416) 295694 (1561539309) 804923 (1580916714) 526743 (1589814030) 950362 (1576998920) 373982 (1587320434) 448032 (1579574671) 417523 (1553807091) 890540 (1541384870) 486017 (1576252526) 501049 (1585237551) 184145 (1577120906) 323117 (1550674145) 752134 (1583896379) 950097 (1575157370) 704461 (1567652497) 679902 (1581865622) 626195 (1575674868) 827447 (1565725551) 71734 (1577588921) 509649 (1563988216) 317245 (1566794544) 965396 (1589114636) 356873 (1561432020) 
     dis: 	0.624 0.634 0.667 0.745 0.747 0.749 0.771 0.772 0.775 0.775 0.777 0.788 0.790 0.795 0.799 0.803 0.805 0.806 0.814 0.822 0.828 0.837 0.838 0.842 0.854 0.864 0.868 0.869 0.873 0.875 0.876 0.877 0.878 0.881 0.885 0.886 0.887 0.888 0.888 0.893 0.894 0.894 0.896 0.896 0.896 0.896 0.896 0.897 0.898 0.898 0.898 0.900 0.902 0.903 0.904 0.905 0.906 0.906 0.907 0.907 0.908 0.908 0.909 0.910 0.910 0.912 0.913 0.913 0.914 0.916 0.917 0.917 0.917 0.918 0.918 0.919 0.919 0.919 0.920 0.921 0.921 0.921 0.922 0.923 0.924 0.924 0.924 0.925 0.926 0.926 0.927 0.927 0.927 0.928 0.930 0.931 0.931 0.934 0.934 0.934 
query 1 nn's (1502815998, 1574739098): 741325 (1559616195) 666880 (1555641433) 979250 (1523372340) 622447 (1532959985) 427146 (1514695882) 803332 (1530141155) 428754 (1560720094) 110189 (1507487399) 139424 (1535633696) 284310 (1570817806) 964018 (1566639637) 939001 (1521863047) 928093 (1551573119) 795520 (1549367888) 421889 (1509323403) 329834 (1552801370) 7931 (1531328513) 994014 (1549410785) 459927 (1570948131) 979295 (1567526425) 848169 (1567967943) 997966 (1560111653) 832389 (1509148358) 661716 (1569475757) 104425 (1517937828) 710350 (1543853777) 848037 (1547627912) 399497 (1531827001) 866328 (1550960142) 85059 (1560480821) 195548 (1519575345) 630058 (1510985967) 671340 (1545504039) 577336 (1551645910) 743973 (1565255174) 326649 (1542991586) 709969 (1549840943) 964128 (1566424023) 408156 (1550161639) 272839 (1567350368) 178695 (1539523827) 857939 (1506859251) 226358 (1565225638) 885087 (1525644326) 925374 (1547210027) 395948 (1572268410) 721597 (1560048937) 544577 (1529068259) 925657 (1569885810) 271263 (1523394425) 324349 (1565636095) 620586 (1542847663) 55881 (1516654636) 837200 (1517967912) 107066 (1564445038) 557922 (1542237514) 169444 (1559524323) 795310 (1572108672) 784003 (1503860978) 418536 (1508889764) 320719 (1526407679) 935736 (1516385240) 770454 (1561685089) 769260 (1570050053) 80871 (1546322460) 489550 (1561300577) 584466 (1558116296) 816247 (1563724766) 135640 (1562247065) 62978 (1548008868) 785418 (1513559759) 687772 (1567207126) 916706 (1560980031) 855763 (1569114081) 244515 (1565195570) 288542 (1507728447) 77283 (1545499206) 811301 (1551198823) 82481 (1518972141) 672841 (1520507128) 417828 (1564258459) 750270 (1568905945) 1519 (1561555264) 384623 (1530652501) 116279 (1540745988) 388764 (1538816911) 86484 (1550619400) 344524 (1553054923) 242179 (1574602885) 213143 (1530845306) 885260 (1562875914) 232066 (1563834787) 366937 (1530677494) 722531 (1562614185) 865350 (1562057425) 722158 (1557686757) 958421 (1560503853) 678677 (1525640581) 785513 (1568160267) 485598 (1553564926) 
     dis: 	0.099 0.100 0.101 0.103 0.105 0.106 0.108 0.110 0.111 0.111 0.112 0.113 0.113 0.113 0.113 0.113 0.114 0.114 0.115 0.115 0.115 0.116 0.117 0.117 0.117 0.117 0.118 0.118 0.118 0.118 0.118 0.118 0.119 0.119 0.119 0.120 0.120 0.120 0.120 0.121 0.121 0.122 0.122 0.122 0.122 0.122 0.122 0.122 0.123 0.123 0.124 0.124 0.125 0.125 0.125 0.126 0.126 0.126 0.126 0.126 0.127 0.127 0.127 0.127 0.128 0.128 0.128 0.129 0.129 0.129 0.129 0.129 0.129 0.130 0.130 0.130 0.130 0.130 0.130 0.130 0.130 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.132 0.132 0.132 0.132 0.132 
query 2 nn's (1565134124, 1606255797): 964377 (1605131892) 306439 (1575579764) 757728 (1605423787) 75885 (1601934153) 445298 (1589162214) 71515 (1570882811) 374226 (1576918189) 771849 (1570744783) 903106 (1586146246) 328504 (1595799020) 792564 (1597961764) 498270 (1586402085) 751228 (1585488453) 530996 (1598262380) 161603 (1602887962) 494541 (1567102094) 737868 (1571342287) 328089 (1574112193) 435452 (1574701387) 837851 (1605837809) 41616 (1599772018) 929527 (1587699711) 609504 (1590756439) 971858 (1600907724) 507734 (1605297824) 800558 (1578206579) 633139 (1583107000) 610678 (1584998424) 952981 (1588948381) 919763 (1580427352) 25586 (1592565722) 222791 (1569733461) 625921 (1580310462) 589140 (1597778814) 24425 (1584502238) 882709 (1573089021) 726914 (1582911767) 627502 (1584624938) 10316 (1600442741) 33572 (1567059144) 879865 (1599868306) 988519 (1599418976) 233822 (1587156920) 684897 (1579890463) 192903 (1602694233) 253786 (1598570829) 230054 (1603647309) 870630 (1568931614) 728355 (1598234783) 976907 (1594577610) 136876 (1579879526) 509068 (1582362871) 341373 (1582339286) 403717 (1587585205) 491378 (1598099263) 910005 (1589155576) 844350 (1601083260) 88997 (1597461015) 985107 (1565328361) 74992 (1573424430) 812326 (1580129904) 625576 (1604050293) 319345 (1568052528) 645543 (1585948706) 557020 (1584521629) 660131 (1601954615) 550905 (1590498833) 184796 (1580838071) 470869 (1582932711) 14154 (1594153934) 915391 (1601243129) 826279 (1597417912) 304775 (1575151723) 578528 (1604204574) 201205 (1586171256) 459595 (1582500502) 884477 (1588323027) 44865 (1586305134) 965924 (1600027560) 490170 (1604285031) 258161 (1574306665) 312490 (1604872882) 752639 (1583106240) 187604 (1594862700) 623030 (1597864688) 476119 (1601567589) 435592 (1590078863) 962379 (1591499930) 985401 (1586115013) 351702 (1601462660) 785841 (1588265143) 620162 (1566431760) 89667 (1574102696) 546876 (1605386607) 310380 (1597000036) 780551 (1599435257) 198935 (1603661610) 356369 (1600690480) 290482 (1589215284) 63845 (1588094783) 
     dis: 	0.225 0.237 0.237 0.254 0.261 0.262 0.264 0.264 0.269 0.271 0.273 0.276 0.276 0.276 0.276 0.277 0.277 0.278 0.278 0.279 0.280 0.280 0.282 0.282 0.282 0.283 0.283 0.284 0.285 0.286 0.287 0.287 0.287 0.287 0.288 0.288 0.289 0.290 0.290 0.290 0.290 0.291 0.291 0.292 0.292 0.292 0.294 0.294 0.294 0.295 0.296 0.296 0.297 0.297 0.297 0.297 0.298 0.300 0.301 0.301 0.302 0.302 0.302 0.302 0.303 0.304 0.304 0.305 0.305 0.305 0.305 0.305 0.305 0.306 0.306 0.306 0.306 0.307 0.307 0.307 0.307 0.307 0.308 0.308 0.308 0.309 0.309 0.309 0.309 0.309 0.309 0.310 0.310 0.310 0.311 0.311 0.311 0.311 0.312 0.312 
query 3 nn's (1564977898, 1606128091): 889987 (1593644784) 783586 (1584449301) 124464 (1588791594) 640717 (1593715105) 595884 (1603585196) 687871 (1584368476) 889856 (1574977953) 306883 (1582504320) 382748 (1593824389) 456770 (1569878368) 110113 (1584365036) 369955 (1572446350) 35100 (1602181028) 108295 (1585156706) 1172 (1593437402) 183160 (1602553401) 27812 (1566082536) 810505 (1600367373) 758927 (1600115067) 669781 (1599946426) 879049 (1580410467) 269754 (1600944924) 170065 (1567980012) 469326 (1591653206) 555783 (1582924247) 725969 (1596031378) 226331 (1587219459) 636892 (1588778659) 671717 (1569449284) 622714 (1601863068) 345300 (1592195475) 899709 (1569431812) 174382 (1591143332) 910519 (1596209853) 863296 (1568848990) 225830 (1582762176) 4433 (1598650487) 800827 (1581281066) 989223 (1601168056) 43568 (1574027594) 391302 (1573059058) 431136 (1591290445) 585483 (1591851301) 397607 (1576582831) 402867 (1586944643) 696027 (1565089229) 208236 (1570403595) 472875 (1570825151) 184010 (1592663456) 638495 (1591051278) 799434 (1571614920) 479354 (1574296216) 583701 (1579282290) 882799 (1602614385) 301836 (1586460731) 17746 (1578159083) 931871 (1577236835) 684978 (1569892488) 533587 (1578734941) 567499 (1598482734) 433518 (1571765207) 430216 (1590828473) 100162 (1603446100) 328860 (1580625037) 218254 (1585421290) 247163 (1588394370) 808853 (1600624761) 309349 (1590795708) 418179 (1569261639) 412295 (1592051871) 358247 (1598283739) 135464 (1601302603) 222643 (1586742508) 341069 (1569852456) 332772 (1591201180) 694334 (1583158570) 553746 (1565242336) 242265 (1582348130) 201176 (1581392986) 944408 (1596325783) 923128 (1584271014) 723056 (1596423636) 807512 (1565479561) 237881 (1577944076) 935542 (1579374712) 631191 (1576790924) 430670 (1566812498) 706869 (1571407578) 480847 (1575805769) 191420 (1567611844) 315020 (1570876084) 37631 (1569700468) 302971 (1604786015) 496411 (1596262404) 130248 (1584742028) 521807 (1584918824) 20577 (1567996955) 157117 (1582132864) 850509 (1589330635) 231004 (1598567793) 
     dis: 	0.402 0.416 0.445 0.452 0.456 0.460 0.467 0.481 0.497 0.497 0.500 0.501 0.502 0.507 0.507 0.508 0.509 0.509 0.511 0.513 0.513 0.514 0.515 0.517 0.517 0.520 0.520 0.523 0.524 0.526 0.527 0.527 0.527 0.528 0.529 0.530 0.531 0.532 0.532 0.533 0.534 0.535 0.536 0.537 0.537 0.538 0.538 0.538 0.538 0.541 0.542 0.542 0.542 0.543 0.544 0.544 0.544 0.545 0.545 0.547 0.547 0.547 0.549 0.550 0.551 0.551 0.552 0.552 0.553 0.553 0.553 0.554 0.554 0.555 0.555 0.559 0.559 0.559 0.559 0.560 0.560 0.560 0.560 0.561 0.561 0.561 0.561 0.561 0.562 0.562 0.562 0.562 0.564 0.564 0.564 0.565 0.565 0.565 0.565 0.566 
query 4 nn's (1486429184, 1570175082): 582698 (1557087889) 959629 (1553076435) 279888 (1555515184) 46163 (1552605357) 191044 (1542912543) 754904 (1532757000) 68136 (1537086660) 231993 (1563749968) 700754 (1557101934) 60658 (1512331918) 54130 (1553866600) 556169 (1553542108) 589135 (1547166816) 789873 (1564175719) 929991 (1548794594) 455512 (1559505416) 834676 (1547757785) 59094 (1536774042) 218677 (1567427396) 403555 (1549502178) 330129 (1525225883) 565451 (1563280600) 222228 (1543263211) 902523 (1564343178) 969773 (1527858141) 567017 (1561466150) 584911 (1538696418) 18995 (1561278454) 351217 (1545147659) 861337 (1559160334) 979493 (1540438177) 143565 (1516103937) 481846 (1512692187) 590482 (1550192676) 282395 (1552886840) 616623 (1529427583) 262276 (1518198483) 870723 (1530111079) 511053 (1554404630) 573206 (1557940034) 857192 (1554140364) 732037 (1558530545) 805996 (1530049195) 507409 (1565232420) 655488 (1505816775) 605725 (1557494891) 577889 (1558192255) 51681 (1535136336) 147188 (1501610900) 173575 (1509173034) 309894 (1532146088) 842541 (1569071674) 678901 (1558868874) 500007 (1555794424) 584115 (1555479090) 204098 (1565367374) 285533 (1567392541) 569466 (1522175329) 148545 (1518097309) 392242 (1497525223) 760527 (1492818655) 907116 (1563321366) 395799 (1560127897) 244038 (1543691184) 954881 (1561262229) 948484 (1569979308) 341328 (1495582876) 948602 (1555862584) 573896 (1562646014) 367708 (1513407029) 464808 (1521378210) 923538 (1527525691) 235772 (1551117248) 56749 (1521485101) 43574 (1492546668) 490515 (1562711345) 954446 (1568380532) 101369 (1531669788) 635293 (1564014847) 440301 (1534385643) 850663 (1553673926) 435576 (1516246088) 921524 (1559055905) 709494 (1563922629) 685016 (1551067146) 311214 (1546572875) 583639 (1510024142) 470637 (1514523703) 959099 (1569783405) 596233 (1565428603) 745769 (1554844132) 222638 (1521059736) 206145 (1563064441) 604226 (1538444207) 139832 (1569448729) 156056 (1513534578) 831639 (1563684890) 940668 (1566892372) 341468 (1497809821) 853874 (1540154048) 
     dis: 	0.261 0.293 0.298 0.299 0.300 0.300 0.304 0.307 0.307 0.307 0.308 0.308 0.311 0.312 0.315 0.316 0.316 0.317 0.319 0.320 0.322 0.323 0.324 0.325 0.325 0.326 0.326 0.327 0.327 0.327 0.328 0.330 0.330 0.331 0.331 0.332 0.333 0.333 0.333 0.334 0.334 0.334 0.334 0.335 0.335 0.337 0.337 0.337 0.337 0.338 0.339 0.339 0.339 0.340 0.341 0.342 0.343 0.343 0.344 0.346 0.346 0.347 0.347 0.347 0.348 0.348 0.348 0.349 0.349 0.350 0.350 0.350 0.350 0.351 0.352 0.352 0.352 0.352 0.353 0.353 0.354 0.354 0.354 0.354 0.355 0.355 0.355 0.356 0.356 0.357 0.358 0.358 0.358 0.359 0.359 0.360 0.360 0.360 0.360 0.361 
[ 116.604s ] *** Query time: 109.106
qps: 91.654
 *** ivfpq recall 
ivfpq get 962288 postive res from 1000000 results, recall@100:0.962
recall dist(10% per bucket): 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.003 0.021 0.961 0.014 
finished ivfpq index examples
[ 116.633s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 100 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_100.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_256 150 512"
	User time (seconds): 115.37
	System time (seconds): 0.89
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:56.73
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 1348516
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 2
	Minor (reclaiming a frame) page faults: 335699
	Voluntary context switches: 974
	Involuntary context switches: 167
	Swaps: 0
	File system inputs: 149520
	File system outputs: 32
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
