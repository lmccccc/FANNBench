Start time: 08:19
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 1.560s ] Loaded metadata, 10000000 attr's found
[ 1.560s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.566s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json
[ 1.569s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json
[ 1.584s ] Loaded ground truth, gt_size: 10
[ 1.584s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.75 (867450974)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824519639)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959696)
   3. nb of reciprocal neighbors: 102.05
   4. nb of neighbors that are also neighbor-of-neighbors: 966.92 (241691157)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 935.91 (5813894)
   3. nb of reciprocal neighbors: 668.19
   4. nb of neighbors that are also neighbor-of-neighbors: 935.46 (5811092)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 132.94 (18611)
   3. nb of reciprocal neighbors: 131.03
   4. nb of neighbors that are also neighbor-of-neighbors: 132.45 (18543)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999776 nodes
	level 1: 249957 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2751.486s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.190
[ 3261.462s ] Query results (vector ids, then distances):
query 0 nn's (15254): 2898305 (16783) 4538400 (25471) 6984373 (34761) 5579551 (33289) 7164607 (26189) 9925949 (31632) 1077702 (24638) 5770330 (26213) 5643020 (22999) 3255720 (26162) 
     dis: 	67180.000 76603.000 76880.000 78568.000 80358.000 80660.000 80790.000 81243.000 82000.000 82432.000 
query 1 nn's (35254): 8449497 (78596) 5552416 (65287) 1263214 (70019) 9791343 (75449) 3309105 (69952) 1745130 (71531) 6378991 (73833) 8675999 (69203) 7692715 (63767) 9933148 (62209) 
     dis: 	32633.000 42944.000 47608.000 51493.000 51760.000 54734.000 54869.000 56407.000 56490.000 57000.000 
query 2 nn's (62177): 3900297 (92680) 1931585 (85608) 289025 (89537) 3493381 (96585) 9416415 (91891) 9068473 (87943) 8432027 (82488) 3832486 (91890) 1198061 (97380) 9541874 (91850) 
     dis: 	43033.000 48317.000 48416.000 51043.000 51724.000 52145.000 53772.000 54273.000 54288.000 54558.000 
query 3 nn's (82177): 4083199 (34822) 8174765 (34010) 3421136 (41115) 2358683 (31685) 3041965 (42645) 8419826 (36357) 6148687 (35583) 7914184 (37145) 1911911 (42656) 2218358 (41867) 
     dis: 	3910.000 5180.000 5596.000 5694.000 6095.000 6096.000 6437.000 6624.000 6655.000 6693.000 
query 4 nn's (79782): 5493369 (80149) 8647938 (78603) 4962535 (73941) 2974906 (84868) 4901952 (73111) 9182395 (68368) 5529985 (76273) 7476351 (70787) 1243221 (68448) 3905693 (73811) 
     dis: 	81626.000 91060.000 93259.000 94292.000 95535.000 97667.000 98439.000 98713.000 99070.000 99349.000 
[ 3261.462s ] *** Query time: 18.237
qps: 548.346
 *** acorn recall 
efs:20
acorn get 75294 postive res from 100000 results, recall@10:0.753
recall dist(10% per bucket): 0.008 0.012 0.020 0.035 0.052 0.076 0.088 0.121 0.144 0.179 0.265 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3267.601s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 12117365
ndis: 0
nreorder: 0
average distance computations per query: 1211.736
[ 3267.601s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64 20 128"
	User time (seconds): 3145.75
	System time (seconds): 114.87
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 54:29.64
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114638432
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 3
	Minor (reclaiming a frame) page faults: 63284902
	Voluntary context switches: 36217
	Involuntary context switches: 4201
	Swaps: 0
	File system inputs: 2411496
	File system outputs: 48
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 18:07
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_out_dist.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_out_dist_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 1.243s ] Loaded metadata, 10000000 attr's found
[ 1.243s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.246s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_out_dist.json
[ 1.248s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_out_dist_10.json
[ 1.259s ] Loaded ground truth, gt_size: 10
[ 1.259s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.75 (867450974)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824519639)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959696)
   3. nb of reciprocal neighbors: 102.05
   4. nb of neighbors that are also neighbor-of-neighbors: 966.92 (241691157)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 935.91 (5813894)
   3. nb of reciprocal neighbors: 668.19
   4. nb of neighbors that are also neighbor-of-neighbors: 935.46 (5811092)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 132.94 (18611)
   3. nb of reciprocal neighbors: 131.03
   4. nb of neighbors that are also neighbor-of-neighbors: 132.45 (18543)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999776 nodes
	level 1: 249957 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2657.957s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.190
[ 3131.583s ] Query results (vector ids, then distances):
query 0 nn's (690): 4160485 (18340) 2898305 (16783) 5514922 (12940) 4738758 (11351) 788117 (12895) 9313115 (10541) 6951413 (7394) 578867 (18379) 1892471 (7377) 419470 (2709) 
     dis: 	65950.000 67180.000 72798.000 74463.000 78653.000 79682.000 80726.000 80841.000 82386.000 82431.000 
query 1 nn's (20690): 4234271 (10566) 7501440 (6611) 9219153 (6637) 5271910 (5870) 4922660 (1131) 7143179 (3507) 296178 (6602) 9781041 (10548) 5516040 (6634) 9245954 (5874) 
     dis: 	44439.000 46910.000 50730.000 52252.000 56486.000 57268.000 57313.000 57738.000 57779.000 58737.000 
query 2 nn's (0): 199400 (38630) 9262583 (36356) 9554416 (30928) 4757879 (36366) 8068558 (26985) 2994193 (27765) 3942637 (42654) 9457112 (30097) 3795529 (34831) 6114289 (41840) 
     dis: 	49395.000 50601.000 52237.000 53215.000 53350.000 53360.000 53664.000 54765.000 56262.000 56627.000 
query 3 nn's (10578): 1527942 (20684) 7301932 (9775) 3643741 (7428) 1985932 (11352) 6917633 (15999) 4904828 (9813) 727241 (22300) 9010353 (14430) 8649378 (15999) 4998281 (8975) 
     dis: 	4309.000 5240.000 5279.000 5371.000 5626.000 6194.000 6237.000 6311.000 6468.000 6624.000 
query 4 nn's (25853): 7091990 (41850) 1751938 (31660) 1141817 (34826) 1530216 (40303) 7358946 (42608) 9570381 (25431) 7559534 (24590) 6699578 (42678) 6258948 (43396) 7907570 (41089) 
     dis: 	77167.000 84283.000 85933.000 86529.000 87070.000 92925.000 93517.000 94180.000 94672.000 95354.000 
[ 3131.584s ] *** Query time: 8.392
qps: 1191.560
 *** acorn recall 
efs:20
acorn get 74961 postive res from 100000 results, recall@10:0.750
recall dist(10% per bucket): 0.010 0.010 0.022 0.038 0.053 0.070 0.097 0.118 0.139 0.178 0.264 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3135.695s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 12100245
ndis: 0
nreorder: 0
average distance computations per query: 1210.025
[ 3135.695s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_out_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_out_dist_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64 20 128"
	User time (seconds): 3050.96
	System time (seconds): 75.98
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 52:16.89
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114642620
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 2
	Minor (reclaiming a frame) page faults: 30675519
	Voluntary context switches: 45914
	Involuntary context switches: 4043
	Swaps: 0
	File system inputs: 1353624
	File system outputs: 56
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 03:24
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 1.210s ] Loaded metadata, 10000000 attr's found
[ 1.210s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.212s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json
[ 1.215s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json
[ 1.226s ] Loaded ground truth, gt_size: 10
[ 1.226s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.75 (867450974)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824519639)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959696)
   3. nb of reciprocal neighbors: 102.05
   4. nb of neighbors that are also neighbor-of-neighbors: 966.92 (241691157)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 935.91 (5813894)
   3. nb of reciprocal neighbors: 668.19
   4. nb of neighbors that are also neighbor-of-neighbors: 935.46 (5811092)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 132.94 (18611)
   3. nb of reciprocal neighbors: 131.03
   4. nb of neighbors that are also neighbor-of-neighbors: 132.45 (18543)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999776 nodes
	level 1: 249957 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2650.515s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.190
[ 3126.840s ] Query results (vector ids, then distances):
query 0 nn's (15254): 2898305 (16783) 4538400 (25471) 6984373 (34761) 5579551 (33289) 7164607 (26189) 9925949 (31632) 1077702 (24638) 5770330 (26213) 5643020 (22999) 3255720 (26162) 
     dis: 	67180.000 76603.000 76880.000 78568.000 80358.000 80660.000 80790.000 81243.000 82000.000 82432.000 
query 1 nn's (35254): 8449497 (78596) 5552416 (65287) 1263214 (70019) 9791343 (75449) 3309105 (69952) 1745130 (71531) 6378991 (73833) 8675999 (69203) 7692715 (63767) 9933148 (62209) 
     dis: 	32633.000 42944.000 47608.000 51493.000 51760.000 54734.000 54869.000 56407.000 56490.000 57000.000 
query 2 nn's (62177): 3900297 (92680) 1931585 (85608) 289025 (89537) 3493381 (96585) 9416415 (91891) 9068473 (87943) 8432027 (82488) 3832486 (91890) 1198061 (97380) 9541874 (91850) 
     dis: 	43033.000 48317.000 48416.000 51043.000 51724.000 52145.000 53772.000 54273.000 54288.000 54558.000 
query 3 nn's (82177): 4083199 (34822) 8174765 (34010) 3421136 (41115) 2358683 (31685) 3041965 (42645) 8419826 (36357) 6148687 (35583) 7914184 (37145) 1911911 (42656) 2218358 (41867) 
     dis: 	3910.000 5180.000 5596.000 5694.000 6095.000 6096.000 6437.000 6624.000 6655.000 6693.000 
query 4 nn's (79782): 5493369 (80149) 8647938 (78603) 4962535 (73941) 2974906 (84868) 4901952 (73111) 9182395 (68368) 5529985 (76273) 7476351 (70787) 1243221 (68448) 3905693 (73811) 
     dis: 	81626.000 91060.000 93259.000 94292.000 95535.000 97667.000 98439.000 98713.000 99070.000 99349.000 
[ 3126.840s ] *** Query time: 13.000
qps: 769.218
 *** acorn recall 
efs:20
acorn get 75294 postive res from 100000 results, recall@10:0.753
recall dist(10% per bucket): 0.008 0.012 0.020 0.035 0.052 0.076 0.088 0.121 0.144 0.179 0.265 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3132.650s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 12117365
ndis: 0
nreorder: 0
average distance computations per query: 1211.736
[ 3132.650s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_20000_1_100000_in_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_20000_1_100000_in_dist_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64 20 128"
	User time (seconds): 3049.56
	System time (seconds): 75.05
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 52:14.43
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114640016
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 30410163
	Voluntary context switches: 42950
	Involuntary context switches: 1740
	Swaps: 0
	File system inputs: 2712272
	File system outputs: 56
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:08
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_30000_1_100000_in_dist.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_30000_1_100000_in_dist_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 2.811s ] Loaded metadata, 10000000 attr's found
[ 2.811s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 2.817s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_30000_1_100000_in_dist.json
[ 2.823s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_30000_1_100000_in_dist_10.json
[ 2.852s ] Loaded ground truth, gt_size: 10
[ 2.852s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.75 (867450974)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824519639)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959696)
   3. nb of reciprocal neighbors: 102.05
   4. nb of neighbors that are also neighbor-of-neighbors: 966.92 (241691157)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 935.91 (5813894)
   3. nb of reciprocal neighbors: 668.19
   4. nb of neighbors that are also neighbor-of-neighbors: 935.46 (5811092)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 132.94 (18611)
   3. nb of reciprocal neighbors: 131.03
   4. nb of neighbors that are also neighbor-of-neighbors: 132.45 (18543)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999776 nodes
	level 1: 249957 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 3016.576s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.277
[ 3609.840s ] Query results (vector ids, then distances):
query 0 nn's (58293): 6141318 (63712) 2515600 (78596) 1020562 (76197) 796249 (62995) 1174332 (62191) 2115887 (77017) 9251169 (62957) 4874283 (84803) 4689336 (84094) 7873580 (83316) 
     dis: 	73183.000 73465.000 76767.000 79534.000 79542.000 80780.000 81847.000 82000.000 82232.000 82438.000 
query 1 nn's (88293): 285986 (32478) 4907604 (30932) 9492445 (33263) 3645374 (48863) 9958454 (41038) 8596968 (50404) 7343838 (32423) 7120642 (50430) 2993914 (56694) 5589386 (50455) 
     dis: 	43778.000 46066.000 48691.000 50948.000 51055.000 52768.000 54601.000 54684.000 55326.000 56410.000 
query 2 nn's (30225): 5982237 (17674) 9262583 (36356) 8132849 (13703) 9554416 (30928) 4279056 (21460) 4757879 (36366) 8068558 (26985) 2994193 (27765) 4665202 (19912) 2601636 (7451) 
     dis: 	50144.000 50601.000 50997.000 52237.000 52719.000 53215.000 53350.000 53360.000 53809.000 53913.000 
query 3 nn's (60225): 4083199 (34822) 1527942 (20684) 8174765 (34010) 7301932 (9775) 1985932 (11352) 5124856 (24615) 6917633 (15999) 2358683 (31685) 8419826 (36357) 4904828 (9813) 
     dis: 	3910.000 4309.000 5180.000 5240.000 5371.000 5492.000 5626.000 5694.000 6096.000 6194.000 
query 4 nn's (6367): 811272 (3465) 6578584 (18363) 3389697 (19174) 7724095 (2689) 3832333 (8215) 2908498 (10554) 5709057 (18391) 2251576 (16029) 9383376 (10517) 3839204 (5880) 
     dis: 	81973.000 82172.000 84350.000 86698.000 87409.000 88949.000 89153.000 91292.000 92692.000 94216.000 
[ 3609.840s ] *** Query time: 16.119
qps: 620.398
 *** acorn recall 
efs:20
acorn get 74243 postive res from 100000 results, recall@10:0.742
recall dist(10% per bucket): 0.010 0.014 0.023 0.039 0.054 0.076 0.093 0.119 0.142 0.175 0.254 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3615.015s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 12804155
ndis: 0
nreorder: 0
average distance computations per query: 1280.416
[ 3615.015s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_30000_1_100000_in_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_30000_1_100000_in_dist_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64 20 128"
	User time (seconds): 3492.00
	System time (seconds): 104.41
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:00:16
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114635448
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 2
	Minor (reclaiming a frame) page faults: 41205591
	Voluntary context switches: 42819
	Involuntary context switches: 51521
	Swaps: 0
	File system inputs: 1872656
	File system outputs: 56
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 07:10
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_40000_1_100000_in_dist.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_40000_1_100000_in_dist_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 1.257s ] Loaded metadata, 10000000 attr's found
[ 1.257s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.261s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_40000_1_100000_in_dist.json
[ 1.263s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_40000_1_100000_in_dist_10.json
[ 1.274s ] Loaded ground truth, gt_size: 10
[ 1.274s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.75 (867450974)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824519639)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959696)
   3. nb of reciprocal neighbors: 102.05
   4. nb of neighbors that are also neighbor-of-neighbors: 966.92 (241691157)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 935.91 (5813894)
   3. nb of reciprocal neighbors: 668.19
   4. nb of neighbors that are also neighbor-of-neighbors: 935.46 (5811092)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 132.94 (18611)
   3. nb of reciprocal neighbors: 131.03
   4. nb of neighbors that are also neighbor-of-neighbors: 132.45 (18543)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999776 nodes
	level 1: 249957 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2922.724s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.360
[ 3447.919s ] Query results (vector ids, then distances):
query 0 nn's (38442): 9536881 (55153) 9485971 (52018) 7866119 (51231) 796249 (62995) 6552863 (43448) 888010 (41841) 9251169 (62957) 3663987 (52739) 1665852 (61395) 906203 (62879) 
     dis: 	78206.000 78877.000 79448.000 79534.000 80001.000 80692.000 81847.000 82852.000 83197.000 83214.000 
query 1 nn's (78442): 4234271 (10566) 1273419 (11359) 7501440 (6611) 1233453 (14431) 9219153 (6637) 469965 (12169) 6265610 (19928) 5271910 (5870) 8879018 (22263) 4922660 (1131) 
     dis: 	44439.000 46522.000 46910.000 48662.000 50730.000 50753.000 51836.000 52252.000 56123.000 56486.000 
query 2 nn's (0): 5982237 (17674) 8132849 (13703) 9554416 (30928) 4279056 (21460) 9410320 (416) 5988705 (7412) 8068558 (26985) 2994193 (27765) 4665202 (19912) 2601636 (7451) 
     dis: 	50144.000 50997.000 52237.000 52719.000 52939.000 53001.000 53350.000 53360.000 53809.000 53913.000 
query 3 nn's (22473): 6151275 (59824) 3421136 (41115) 6411621 (57488) 2892348 (61387) 3041965 (42645) 5224964 (61407) 6942939 (65282) 7914184 (37145) 1911911 (42656) 2218358 (41867) 
     dis: 	4602.000 5596.000 5998.000 6047.000 6095.000 6378.000 6423.000 6624.000 6655.000 6693.000 
query 4 nn's (0): 811272 (3465) 6578584 (18363) 3389697 (19174) 1141817 (34826) 1149636 (34794) 1530216 (40303) 7724095 (2689) 2908498 (10554) 6203168 (28560) 2251576 (16029) 
     dis: 	81973.000 82172.000 84350.000 85933.000 85940.000 86529.000 86698.000 88949.000 89955.000 91292.000 
[ 3447.919s ] *** Query time: 19.991
qps: 500.236
 *** acorn recall 
efs:20
acorn get 73509 postive res from 100000 results, recall@10:0.735
recall dist(10% per bucket): 0.011 0.016 0.028 0.041 0.054 0.075 0.097 0.116 0.141 0.173 0.249 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3452.438s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 13080518
ndis: 0
nreorder: 0
average distance computations per query: 1308.052
[ 3452.438s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/qrangesel_40000_1_100000_in_dist.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_dist/sif_gt_sel_40000_1_100000_in_dist_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_dist_M40_ga25_Mb64 20 128"
	User time (seconds): 3345.90
	System time (seconds): 86.51
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 57:34.39
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114640572
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 9
	Minor (reclaiming a frame) page faults: 43262129
	Voluntary context switches: 46493
	Involuntary context switches: 44461
	Swaps: 0
	File system inputs: 2047104
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
