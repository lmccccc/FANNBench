Start time: 00:53
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 20
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.138s ] Loaded metadata, 2000000 attr's found
[ 0.138s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.151s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.155s ] Loaded 10000 redcaps1m queries
[ 0.162s ] Loaded ground truth, gt_size: 10
[ 0.162s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.894s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.501
[ 99.860s ] Query results (vector ids, then distances):
query 0 nn's (6, 1058, 84346): 727106 (6) 562528 (19) 646437 (4080) 864174 (6) 451328 (6) 64073 (3080) 302070 (6) 812018 (10) 7102 (10) 302187 (23894) 
     dis: 	0.632 0.638 0.691 0.741 0.742 0.750 0.755 0.760 0.761 0.789 
query 1 nn's (6, 7061, 90400): 741325 (9382) 660394 (19) 622447 (83917) 964028 (6) 199154 (6) 427146 (6) 361663 (21698) 361537 (83842) 428754 (6) 30989 (38653) 
     dis: 	0.100 0.103 0.103 0.106 0.106 0.106 0.106 0.107 0.108 0.109 
query 2 nn's (6, 16654, 99978): 355537 (64184) 880455 (86265) 964377 (94796) 306439 (57083) 757728 (6) 193180 (10) 75885 (4390) 620585 (91800) 273250 (10) 374226 (10) 
     dis: 	0.223 0.225 0.226 0.238 0.240 0.249 0.257 0.259 0.262 0.262 
query 3 nn's (6, 310, 83602): 689368 (6) 124464 (6) 595884 (10) 889856 (10) 609006 (10) 213744 (6) 306883 (54086) 483626 (6) 382748 (6) 246538 (6) 
     dis: 	0.402 0.447 0.461 0.463 0.464 0.475 0.476 0.496 0.500 0.503 
query 4 nn's (6, 10534, 93885): 582698 (10) 189529 (80737) 931553 (69580) 892178 (6) 421184 (10) 315361 (25656) 227862 (10) 279888 (10) 700754 (6) 231993 (42297) 
     dis: 	0.260 0.280 0.283 0.288 0.289 0.296 0.302 0.302 0.304 0.307 
[ 99.860s ] *** Query time: 42.902
qps: 233.092
 *** ivfpq recall 
ivfpq get 93938 postive res from 100000 results, recall@10:0.939
recall dist(10% per bucket): 0.000 0.000 0.001 0.002 0.004 0.007 0.018 0.040 0.064 0.208 0.657 
finished ivfpq index examples
[ 99.861s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 20 512"
	User time (seconds): 98.45
	System time (seconds): 1.59
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:40.05
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609060
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 651934
	Voluntary context switches: 1
	Involuntary context switches: 74
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 01:32
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_10_2_100000_random_10.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_10_2_100000_random_10_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 20
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.133s ] Loaded metadata, 2000000 attr's found
[ 0.133s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.147s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.149s ] Loaded 10000 redcaps1m queries
[ 0.156s ] Loaded ground truth, gt_size: 10
[ 0.156s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.897s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.100
[ 85.914s ] Query results (vector ids, then distances):
query 0 nn's (10, 66234, 99627): 268161 (96264) 549163 (84314) 334544 (10) 766737 (23599) 606467 (78112) 596166 (6) 533175 (43041) 174023 (64856) 472918 (6) 331521 (12022) 
     dis: 	0.647 0.761 0.809 0.816 0.842 0.844 0.889 0.906 0.909 0.915 
query 1 nn's (10, 15875, 49153): 728340 (6) 803332 (10) 896567 (65282) 7931 (93555) 399497 (54572) 85059 (61117) 441534 (6) 857939 (9912) 377202 (6) 779657 (40034) 
     dis: 	0.101 0.106 0.111 0.114 0.118 0.118 0.118 0.122 0.124 0.124 
query 2 nn's (10, 5684, 39001): 940490 (6) 301614 (6) 773055 (93844) 771849 (63559) 718316 (10) 530996 (10) 995900 (10) 494541 (94906) 328089 (60955) 41616 (6) 
     dis: 	0.246 0.262 0.265 0.266 0.269 0.275 0.277 0.277 0.280 0.283 
query 3 nn's (10, 34629, 67933): 640717 (73295) 108295 (63497) 305237 (27829) 269754 (10) 469326 (6) 219959 (83862) 480974 (6) 799434 (10) 433518 (10) 241189 (70628) 
     dis: 	0.456 0.510 0.514 0.520 0.526 0.530 0.535 0.539 0.549 0.552 
query 4 nn's (10, 11515, 44854): 695669 (51024) 176027 (11855) 440553 (58185) 742084 (6) 311275 (89697) 605725 (34136) 601541 (40926) 760527 (17831) 37748 (6) 954881 (99613) 
     dis: 	0.269 0.269 0.306 0.309 0.323 0.337 0.337 0.345 0.346 0.354 
[ 85.914s ] *** Query time: 35.104
qps: 284.871
 *** ivfpq recall 
ivfpq get 90870 postive res from 100000 results, recall@10:0.909
recall dist(10% per bucket): 0.000 0.000 0.002 0.004 0.008 0.018 0.036 0.056 0.101 0.217 0.558 
finished ivfpq index examples
[ 85.917s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_10_2_100000_random_10.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_10_2_100000_random_10_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 20 512"
	User time (seconds): 82.50
	System time (seconds): 3.60
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:26.12
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609056
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 1252798
	Voluntary context switches: 1
	Involuntary context switches: 183
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:10
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_19_2_100000_random_19.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_19_2_100000_random_19_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 20
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.138s ] Loaded metadata, 2000000 attr's found
[ 0.138s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.150s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.153s ] Loaded 10000 redcaps1m queries
[ 0.160s ] Loaded ground truth, gt_size: 10
[ 0.160s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.954s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 46.036s ] Query results (vector ids, then distances):
query 0 nn's (19, 7547, 27573): 460924 (6) 866249 (5256) 416306 (6) 108433 (25618) 36735 (84012) 571902 (6) 68088 (6) 950599 (72990) 848980 (6) 135359 (39421) 
     dis: 	0.920 1.001 1.033 1.049 1.050 1.065 1.066 1.069 1.072 1.074 
query 1 nn's (19, 19289, 39230): 118532 (6) 654319 (17154) 584544 (6) 946986 (10) 889339 (29860) 702451 (50331) 145137 (64258) 651702 (10) 162918 (6) 254995 (41592) 
     dis: 	0.117 0.132 0.134 0.140 0.141 0.144 0.144 0.145 0.147 0.148 
query 2 nn's (19, 21121, 41068): 610678 (10) 589140 (6) 400571 (22940) 897152 (6) 449631 (8327) 999566 (10) 291604 (6) 150896 (6) 500944 (10) 540591 (13706) 
     dis: 	0.284 0.287 0.341 0.346 0.351 0.358 0.361 0.363 0.366 0.369 
query 3 nn's (19, 28857, 48803): 725969 (89970) 528192 (10) 456993 (77323) 996191 (32188) 82793 (71717) 64584 (10) 324678 (6) 219038 (6) 421460 (6) 191897 (34000) 
     dis: 	0.527 0.574 0.581 0.593 0.603 0.619 0.632 0.639 0.670 0.678 
query 4 nn's (19, 67584, 87612): 143565 (49212) 98599 (5092) 151023 (41123) 96096 (6) 660107 (67257) 224737 (96064) 571456 (20) 439281 (94595) 707476 (10) 212198 (6) 
     dis: 	0.331 0.344 0.376 0.396 0.397 0.426 0.432 0.439 0.443 0.447 
[ 46.036s ] *** Query time: 28.390
qps: 352.237
 *** ivfpq recall 
ivfpq get 77751 postive res from 100000 results, recall@10:0.778
recall dist(10% per bucket): 0.001 0.004 0.014 0.026 0.046 0.070 0.095 0.125 0.153 0.195 0.271 
finished ivfpq index examples
[ 46.037s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_19_2_100000_random_19.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_19_2_100000_random_19_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 20 512"
	User time (seconds): 44.75
	System time (seconds): 1.48
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:46.24
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2605992
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 651937
	Voluntary context switches: 3
	Involuntary context switches: 75
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:42
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_20_2_100000_random_20.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_20_2_100000_random_20_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 20
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.148s ] Loaded metadata, 2000000 attr's found
[ 0.148s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.161s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.164s ] Loaded 10000 redcaps1m queries
[ 0.171s ] Loaded ground truth, gt_size: 10
[ 0.171s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.841s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.001
[ 42.939s ] Query results (vector ids, then distances):
query 0 nn's (20, 62584, 65755): 330621 (59140) 744530 (6) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	1.047 1.117 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (20, 33359, 36530): 47436 (6) 855537 (76169) 849599 (4379) 690014 (19) 379711 (78033) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.164 0.205 0.235 0.286 0.323 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (20, 65022, 68166): 290984 (19) 119482 (10) 251841 (26391) 967691 (15492) 374073 (99421) 455911 (42086) 564980 (6) 111062 (10) 105147 (83848) 403708 (10) 
     dis: 	0.314 0.367 0.385 0.385 0.391 0.399 0.409 0.419 0.471 0.495 
query 3 nn's (20, 77495, 80696): 385406 (10) 137689 (70082) 38395 (82376) 896 (6) 775050 (6) 118060 (6) 445552 (6) -1 (0) -1 (0) -1 (0) 
     dis: 	0.617 0.719 0.751 0.757 0.777 0.860 0.882 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (20, 53915, 57058): 561735 (60870) 210342 (428) 333272 (6) 444339 (19879) 427111 (26140) 224566 (19) 485352 (6) 260315 (75876) 553587 (75347) 356617 (53961) 
     dis: 	0.411 0.417 0.442 0.475 0.483 0.564 0.602 0.610 0.671 0.730 
[ 42.939s ] *** Query time: 27.706
qps: 360.928
 *** ivfpq recall 
ivfpq get 38242 postive res from 100000 results, recall@10:0.382
recall dist(10% per bucket): 0.038 0.100 0.152 0.186 0.174 0.141 0.094 0.061 0.030 0.017 0.007 
finished ivfpq index examples
[ 42.939s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_20_2_100000_random_20.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_20_2_100000_random_20_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 20 512"
	User time (seconds): 41.82
	System time (seconds): 1.27
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:43.09
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609064
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 652055
	Voluntary context switches: 1
	Involuntary context switches: 77
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
