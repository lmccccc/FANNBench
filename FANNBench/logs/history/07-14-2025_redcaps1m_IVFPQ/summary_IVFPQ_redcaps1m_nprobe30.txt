Start time: 00:53
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 30
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.137s ] Loaded metadata, 2000000 attr's found
[ 0.137s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.149s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.152s ] Loaded 10000 redcaps1m queries
[ 0.159s ] Loaded ground truth, gt_size: 10
[ 0.159s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.894s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.501
[ 114.749s ] Query results (vector ids, then distances):
query 0 nn's (6, 1058, 84346): 727106 (6) 562528 (19) 646437 (4080) 864174 (6) 451328 (6) 64073 (3080) 302070 (6) 812018 (10) 7102 (10) 302187 (23894) 
     dis: 	0.632 0.638 0.691 0.741 0.742 0.750 0.755 0.760 0.761 0.789 
query 1 nn's (6, 7061, 90400): 741325 (9382) 660394 (19) 622447 (83917) 964028 (6) 199154 (6) 427146 (6) 361663 (21698) 361537 (83842) 428754 (6) 30989 (38653) 
     dis: 	0.100 0.103 0.103 0.106 0.106 0.106 0.106 0.107 0.108 0.109 
query 2 nn's (6, 16654, 99978): 355537 (64184) 880455 (86265) 964377 (94796) 306439 (57083) 757728 (6) 193180 (10) 75885 (4390) 620585 (91800) 273250 (10) 374226 (10) 
     dis: 	0.223 0.225 0.226 0.238 0.240 0.249 0.257 0.259 0.262 0.262 
query 3 nn's (6, 310, 83602): 689368 (6) 124464 (6) 595884 (10) 889856 (10) 609006 (10) 213744 (6) 306883 (54086) 483626 (6) 382748 (6) 246538 (6) 
     dis: 	0.402 0.447 0.461 0.463 0.464 0.475 0.476 0.496 0.500 0.503 
query 4 nn's (6, 10534, 93885): 582698 (10) 189529 (80737) 931553 (69580) 598411 (49936) 892178 (6) 421184 (10) 315361 (25656) 191044 (6) 227862 (10) 279888 (10) 
     dis: 	0.260 0.280 0.283 0.286 0.288 0.289 0.296 0.300 0.302 0.302 
[ 114.749s ] *** Query time: 59.652
qps: 167.640
 *** ivfpq recall 
ivfpq get 95933 postive res from 100000 results, recall@10:0.959
recall dist(10% per bucket): 0.000 0.000 0.000 0.001 0.002 0.004 0.009 0.020 0.044 0.188 0.733 
finished ivfpq index examples
[ 114.752s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 30 512"
	User time (seconds): 111.26
	System time (seconds): 3.68
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:54.95
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609064
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 1272969
	Voluntary context switches: 1
	Involuntary context switches: 151
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 01:32
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_10_2_100000_random_10.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_10_2_100000_random_10_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 30
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.137s ] Loaded metadata, 2000000 attr's found
[ 0.137s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.148s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.151s ] Loaded 10000 redcaps1m queries
[ 0.158s ] Loaded ground truth, gt_size: 10
[ 0.158s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.856s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.100
[ 89.075s ] Query results (vector ids, then distances):
query 0 nn's (10, 66234, 99627): 268161 (96264) 549163 (84314) 334544 (10) 766737 (23599) 606467 (78112) 596166 (6) 533175 (43041) 174023 (64856) 472918 (6) 331521 (12022) 
     dis: 	0.647 0.761 0.809 0.816 0.842 0.844 0.889 0.906 0.909 0.915 
query 1 nn's (10, 15875, 49153): 728340 (6) 803332 (10) 896567 (65282) 7931 (93555) 399497 (54572) 85059 (61117) 441534 (6) 857939 (9912) 377202 (6) 779657 (40034) 
     dis: 	0.101 0.106 0.111 0.114 0.118 0.118 0.118 0.122 0.124 0.124 
query 2 nn's (10, 5684, 39001): 940490 (6) 301614 (6) 773055 (93844) 771849 (63559) 718316 (10) 530996 (10) 995900 (10) 494541 (94906) 328089 (60955) 41616 (6) 
     dis: 	0.246 0.262 0.265 0.266 0.269 0.275 0.277 0.277 0.280 0.283 
query 3 nn's (10, 34629, 67933): 640717 (73295) 108295 (63497) 305237 (27829) 269754 (10) 276603 (94801) 469326 (6) 219959 (83862) 480974 (6) 799434 (10) 433518 (10) 
     dis: 	0.456 0.510 0.514 0.520 0.522 0.526 0.530 0.535 0.539 0.549 
query 4 nn's (10, 11515, 44854): 695669 (51024) 176027 (11855) 440553 (58185) 742084 (6) 311275 (89697) 604239 (97615) 605725 (34136) 601541 (40926) 760527 (17831) 37748 (6) 
     dis: 	0.269 0.269 0.306 0.309 0.323 0.337 0.337 0.337 0.345 0.346 
[ 89.075s ] *** Query time: 38.453
qps: 260.058
 *** ivfpq recall 
ivfpq get 93959 postive res from 100000 results, recall@10:0.940
recall dist(10% per bucket): 0.000 0.000 0.001 0.002 0.003 0.007 0.018 0.035 0.074 0.208 0.653 
finished ivfpq index examples
[ 89.076s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_10_2_100000_random_10.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_10_2_100000_random_10_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 30 512"
	User time (seconds): 87.75
	System time (seconds): 1.45
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:29.25
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609060
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 651932
	Voluntary context switches: 1
	Involuntary context switches: 120
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:10
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_19_2_100000_random_19.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_19_2_100000_random_19_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 30
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.138s ] Loaded metadata, 2000000 attr's found
[ 0.138s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.150s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.152s ] Loaded 10000 redcaps1m queries
[ 0.160s ] Loaded ground truth, gt_size: 10
[ 0.160s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.912s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 57.299s ] Query results (vector ids, then distances):
query 0 nn's (19, 7547, 27573): 460924 (6) 848510 (6) 866249 (5256) 334275 (964) 416306 (6) 289259 (51425) 108433 (25618) 36735 (84012) 163376 (6) 571902 (6) 
     dis: 	0.920 0.999 1.001 1.015 1.033 1.039 1.049 1.050 1.059 1.065 
query 1 nn's (19, 19289, 39230): 118532 (6) 654319 (17154) 584544 (6) 946986 (10) 889339 (29860) 702451 (50331) 145137 (64258) 651702 (10) 162918 (6) 254995 (41592) 
     dis: 	0.117 0.132 0.134 0.140 0.141 0.144 0.144 0.145 0.147 0.148 
query 2 nn's (19, 21121, 41068): 610678 (10) 589140 (6) 400571 (22940) 897152 (6) 449631 (8327) 999566 (10) 271621 (16942) 291604 (6) 150896 (6) 500944 (10) 
     dis: 	0.284 0.287 0.341 0.346 0.351 0.358 0.361 0.361 0.363 0.366 
query 3 nn's (19, 28857, 48803): 725969 (89970) 528192 (10) 456993 (77323) 996191 (32188) 82793 (71717) 64584 (10) 324678 (6) 942924 (6) 219038 (6) 783340 (10) 
     dis: 	0.527 0.574 0.581 0.593 0.603 0.619 0.632 0.633 0.639 0.649 
query 4 nn's (19, 67584, 87612): 143565 (49212) 98599 (5092) 151023 (41123) 838409 (80116) 96096 (6) 660107 (67257) 224737 (96064) 571456 (20) 439281 (94595) 707476 (10) 
     dis: 	0.331 0.344 0.376 0.393 0.396 0.397 0.426 0.432 0.439 0.443 
[ 57.299s ] *** Query time: 39.688
qps: 251.965
 *** ivfpq recall 
ivfpq get 84422 postive res from 100000 results, recall@10:0.844
recall dist(10% per bucket): 0.000 0.002 0.006 0.012 0.023 0.042 0.064 0.098 0.142 0.228 0.383 
finished ivfpq index examples
[ 57.301s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_19_2_100000_random_19.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_19_2_100000_random_19_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 30 512"
	User time (seconds): 54.29
	System time (seconds): 3.22
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:57.51
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2609060
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 1165321
	Voluntary context switches: 1
	Involuntary context switches: 109
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:42
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_20_2_100000_random_20.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_20_2_100000_random_20_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512
nprobe: 30
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 0.152s ] Loaded metadata, 2000000 attr's found
[ 0.152s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.164s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.167s ] Loaded 10000 redcaps1m queries
[ 0.174s ] Loaded ground truth, gt_size: 10
[ 0.174s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.876s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.001
[ 49.111s ] Query results (vector ids, then distances):
query 0 nn's (20, 62584, 65755): 330621 (59140) 744530 (6) 618507 (82613) 639562 (6) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	1.047 1.117 1.225 1.342 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (20, 33359, 36530): 47436 (6) 855537 (76169) 849599 (4379) 690014 (19) 379711 (78033) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.164 0.205 0.235 0.286 0.323 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (20, 65022, 68166): 290984 (19) 119482 (10) 97834 (10) 251841 (26391) 967691 (15492) 374073 (99421) 455911 (42086) 564980 (6) 111062 (10) 158758 (10) 
     dis: 	0.314 0.367 0.384 0.385 0.385 0.391 0.399 0.409 0.419 0.420 
query 3 nn's (20, 77495, 80696): 385406 (10) 615829 (83162) 137689 (70082) 38395 (82376) 896 (6) 775050 (6) 108257 (33024) 118060 (6) 445552 (6) -1 (0) 
     dis: 	0.617 0.657 0.719 0.751 0.757 0.777 0.783 0.860 0.882 340282346638528859811704183484516925440.000 
query 4 nn's (20, 53915, 57058): 561735 (60870) 210342 (428) 333272 (6) 283898 (6) 444339 (19879) 427111 (26140) 400844 (6) 640147 (71174) 224566 (19) 91880 (10) 
     dis: 	0.411 0.417 0.442 0.455 0.475 0.483 0.495 0.497 0.564 0.601 
[ 49.111s ] *** Query time: 34.497
qps: 289.876
 *** ivfpq recall 
ivfpq get 48764 postive res from 100000 results, recall@10:0.488
recall dist(10% per bucket): 0.014 0.049 0.095 0.137 0.160 0.167 0.138 0.099 0.071 0.042 0.028 
finished ivfpq index examples
[ 49.112s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query_arbi redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/qrangesel_20_2_100000_random_20.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_2_100000_random/sif_gt_sel_20_2_100000_random_20_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_2_100000_random_512 30 512"
	User time (seconds): 47.89
	System time (seconds): 1.39
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:49.28
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2607016
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 651935
	Voluntary context switches: 1
	Involuntary context switches: 58
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
