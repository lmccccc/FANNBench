Start time: 05:20
====================
START: running HNSW_INDEX_CONSTRUCTION, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
index file: /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000
dim: 100
M: 40
ef_construction: 1000
[ 0.000s ] Index Params -- d: 100, M: 40, N: 10000000
====================Vectors====================

[ 0.000s ] Loading database
[ 2.800s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
data loaded, with dim: 100, N=10000000
[ 2.800s ] Indexing database, size 10000000*100 from max 10000000
[ 2.800s ] Adding the vectors to the index
index construction cost:2564.710
[ 2564.710s ] Vectors added to  index
Index vectors added:10000000
====================Write Index================

Total edge:200
Average degree:0.000
[ 2568.704s ] Wrote hnsw index to file: /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000
[2568.704 s] -----DONE-----
[ 2568.704s ] -----DONE-----
	Command being timed: "../faiss/build/demos/hnsw_build spacev10m 10000000 10 128 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000 100 40 1000"
	User time (seconds): 183209.95
	System time (seconds): 233.75
	Percent of CPU this job got: 7139%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 42:49.47
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 12415532
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 26909891
	Voluntary context switches: 14209
	Involuntary context switches: 30701040
	Swaps: 0
	File system inputs: 0
	File system outputs: 14376984
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 07:09
====================
START: running TEST_HNSW, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_100_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_100_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000
ef_search: 100
dim: 100
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 0.829s ] Loaded metadata, 10000000 attr's found
[ 0.829s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 0.868s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
[ 0.900s ] Loaded 10000 spacev10m queries
[ 0.911s ] Loaded ground truth, gt_size: 10
[ 0.911s ] Index Params -- d: 100, N: 10000000
Total edge:200
Average degree:0.000
 load index size: 10000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== HNSW INDEX ====================
[ 16.851s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.001
[ 116.248s ] Query results (vector ids, then distances):
query 0 nn's (15274, 15373): 5769046 (15300) 4702781 (15290) 2493110 (15304) 6353613 (15327) 2893246 (15330) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	9760.000 15871.000 16052.000 19310.000 23289.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (47455, 47554): 7518689 (47475) 8895531 (47457) 2593429 (47531) 9847754 (47504) 3269594 (47508) 6667416 (47485) 5381233 (47489) -1 (0) -1 (0) -1 (0) 
     dis: 	14099.000 16033.000 16302.000 17740.000 18234.000 19968.000 20668.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (2622, 2721): 9318566 (2630) 3913522 (2654) 5355539 (2642) 2610444 (2683) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	13497.000 16142.000 19500.000 20951.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (73957, 74056): 3150044 (74030) 112118 (73999) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	16419.000 18594.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (58381, 58480): 1006805 (58478) 1919573 (58401) 2276653 (58401) 2057281 (58381) 9469682 (58423) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	8433.000 9235.000 11072.000 15117.000 16897.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
[ 116.248s ] *** Query time: 27.818
qps: 359.474
 *** HNSW recall 
HNSW get 21154 postive res from 100000 results, recall@10:0.212
recall dist(10% per bucket): 0.118 0.253 0.273 0.194 0.099 0.043 0.016 0.004 0.000 0.000 0.000 
numbner of vectors searched: 10000, average: 1.000
number of queries for which the candidate list is exhasted: 10000, average: 1.000
number of distances computed: 65022983, average: 6502.298
finished ivfpq index examples
[ 116.251s ] -----DONE-----
	Command being timed: "../faiss/build/demos/hnsw_query spacev10m 10000000 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_100_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_100_1_100000_random_10.json /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000 100 100"
	User time (seconds): 95.67
	System time (seconds): 11.57
	Percent of CPU this job got: 91%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:57.28
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 7263136
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 21
	Minor (reclaiming a frame) page faults: 2850431
	Voluntary context switches: 20705
	Involuntary context switches: 192
	Swaps: 0
	File system inputs: 1518744
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 07:47
====================
START: running TEST_HNSW, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_1000_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_1000_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000
ef_search: 100
dim: 100
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 0.766s ] Loaded metadata, 10000000 attr's found
[ 0.766s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 0.769s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
[ 0.771s ] Loaded 10000 spacev10m queries
[ 0.778s ] Loaded ground truth, gt_size: 10
[ 0.778s ] Index Params -- d: 100, N: 10000000
Total edge:200
Average degree:0.000
 load index size: 10000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== HNSW INDEX ====================
[ 6.800s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 98.347s ] Query results (vector ids, then distances):
query 0 nn's (4494, 5493): 6149370 (4957) 7693645 (4921) 2272371 (5258) 2878726 (5050) 2939481 (4939) 841307 (4995) 9641558 (4559) 7971557 (4951) 7587297 (4745) 3403324 (5319) 
     dis: 	9931.000 12361.000 12379.000 12817.000 12877.000 12937.000 13067.000 13373.000 13914.000 14180.000 
query 1 nn's (37505, 38504): 5755448 (37848) 7789051 (37871) 4358727 (38259) 6449676 (37850) 3563306 (37529) 2765139 (38363) 4415604 (38158) 6208044 (38131) 639982 (37719) 6240841 (38110) 
     dis: 	11958.000 12963.000 13483.000 13615.000 13624.000 13990.000 14087.000 14199.000 14383.000 14388.000 
query 2 nn's (17888, 18887): 2882757 (18506) 2768752 (18434) 7958660 (18369) 7060335 (18263) 6489161 (18260) 192071 (18322) 4001654 (18856) 3411918 (18701) 3343989 (18166) 3852413 (18339) 
     dis: 	7205.000 7919.000 8106.000 10539.000 10585.000 10681.000 11019.000 11573.000 12331.000 12748.000 
query 3 nn's (11109, 12108): 5687185 (12097) 6424074 (11699) 561416 (11821) 8459637 (11541) 1473665 (11327) 3969193 (11781) 7578623 (11167) 5285822 (11716) 3061123 (12077) 9894410 (11400) 
     dis: 	11303.000 11499.000 12457.000 12656.000 13579.000 13592.000 13610.000 13837.000 14346.000 14518.000 
query 4 nn's (17141, 18140): 4786845 (17889) 1240644 (17247) 2074283 (17512) 7484886 (18002) 6029035 (17286) 7743549 (17817) 5448676 (17561) 8303469 (17684) 1076381 (18061) 8499942 (17237) 
     dis: 	6881.000 7141.000 7559.000 7826.000 7998.000 8017.000 8057.000 8435.000 8685.000 8706.000 
[ 98.347s ] *** Query time: 22.751
qps: 439.537
 *** HNSW recall 
HNSW get 61497 postive res from 100000 results, recall@10:0.615
recall dist(10% per bucket): 0.004 0.014 0.034 0.065 0.102 0.148 0.171 0.176 0.148 0.100 0.038 
numbner of vectors searched: 10000, average: 1.000
number of queries for which the candidate list is exhasted: 10000, average: 1.000
number of distances computed: 65022983, average: 6502.298
finished ivfpq index examples
[ 98.348s ] -----DONE-----
	Command being timed: "../faiss/build/demos/hnsw_query spacev10m 10000000 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_1000_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_1000_1_100000_random_10.json /mnt/data/mocheng/dataset/spacev10m/hnsw/index/index_hnsw_sel_1_100000_random_40_1000 100 100"
	User time (seconds): 91.90
	System time (seconds): 6.93
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:39.05
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 7266216
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 1830392
	Voluntary context switches: 1
	Involuntary context switches: 86
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
