Start time: 10:01
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_200_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_200_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 40 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.306s ] Loaded metadata, 10000000 attr's found
[ 1.306s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.309s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_200_1_100000_random.json
[ 1.311s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_200_1_100000_random_10.json
[ 1.322s ] Loaded ground truth, gt_size: 10
[ 1.322s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.74 (867443801)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824510956)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959832)
   3. nb of reciprocal neighbors: 101.32
   4. nb of neighbors that are also neighbor-of-neighbors: 967.27 (241779756)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 937.33 (5822688)
   3. nb of reciprocal neighbors: 670.04
   4. nb of neighbors that are also neighbor-of-neighbors: 936.86 (5819766)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 131.58 (18421)
   3. nb of reciprocal neighbors: 129.71
   4. nb of neighbors that are also neighbor-of-neighbors: 131.07 (18350)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999555 nodes
	level 1: 249955 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2762.836s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 40
selectivity: 0.002
[ 3153.562s ] Query results (vector ids, then distances):
query 0 nn's (73960): 1623122 (74029) 4881180 (74088) 1957179 (74157) 6017101 (74015) 7480712 (74116) 9099679 (74080) 2517965 (74145) 5237678 (74036) 8297477 (74086) 4180978 (73992) 
     dis: 	94590.000 107461.000 107626.000 107872.000 111680.000 111898.000 115636.000 116468.000 117675.000 119373.000 
query 1 nn's (74159): 1918457 (45769) 8464812 (45885) 8267508 (45932) 9769447 (45883) 4196900 (45894) 2117666 (45818) 2654562 (45735) 4861889 (45900) 1219815 (45738) 6953535 (45855) 
     dis: 	98180.000 101174.000 107256.000 110976.000 111852.000 112181.000 113069.000 115907.000 116926.000 119449.000 
query 2 nn's (45733): 3841753 (46235) 451060 (46258) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	177991.000 182681.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (45932): 4735943 (22056) 4992153 (22062) 9975712 (22163) 8757044 (22132) 7017990 (22099) 5892667 (22084) 5864516 (22134) 2249876 (21983) 1118654 (22074) 1472825 (22010) 
     dis: 	27287.000 28871.000 33097.000 40436.000 46063.000 49179.000 51516.000 52435.000 52522.000 54972.000 
query 4 nn's (46226): 5631902 (89204) 7080136 (89321) 7005664 (89231) 8407653 (89266) 2189848 (89237) 5320611 (89222) 7138566 (89238) 3185410 (89292) 7364575 (89369) 2671403 (89362) 
     dis: 	103589.000 112189.000 125203.000 127551.000 127895.000 130026.000 130512.000 131588.000 134216.000 136178.000 
[ 3153.562s ] *** Query time: 16.010
qps: 624.599
 *** acorn recall 
efs:40
acorn get 17143 postive res from 100000 results, recall@10:0.171
recall dist(10% per bucket): 0.461 0.138 0.113 0.089 0.068 0.049 0.037 0.024 0.012 0.007 0.002 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3159.027s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 958233
ndis: 0
nreorder: 0
average distance computations per query: 95.823
[ 3159.027s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_200_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_200_1_100000_random_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 40 128"
	User time (seconds): 3056.39
	System time (seconds): 92.75
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 52:41.01
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114636612
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 28
	Minor (reclaiming a frame) page faults: 36332888
	Voluntary context switches: 47448
	Involuntary context switches: 4307
	Swaps: 0
	File system inputs: 1931640
	File system outputs: 48
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 12:03
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_300_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_300_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 40 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.268s ] Loaded metadata, 10000000 attr's found
[ 1.268s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.271s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_300_1_100000_random.json
[ 1.273s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_300_1_100000_random_10.json
[ 1.285s ] Loaded ground truth, gt_size: 10
[ 1.285s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.74 (867443801)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824510956)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959832)
   3. nb of reciprocal neighbors: 101.32
   4. nb of neighbors that are also neighbor-of-neighbors: 967.27 (241779756)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 937.33 (5822688)
   3. nb of reciprocal neighbors: 670.04
   4. nb of neighbors that are also neighbor-of-neighbors: 936.86 (5819766)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 131.58 (18421)
   3. nb of reciprocal neighbors: 129.71
   4. nb of neighbors that are also neighbor-of-neighbors: 131.07 (18350)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999555 nodes
	level 1: 249955 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2645.136s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 40
selectivity: 0.003
[ 3021.759s ] Query results (vector ids, then distances):
query 0 nn's (64204): 5343331 (64452) 2279313 (64469) 6124488 (64233) 6678280 (64349) 4820946 (64409) 1640515 (64414) 5896275 (64366) 8396289 (64236) 6932692 (64385) 4358070 (64266) 
     dis: 	81853.000 98553.000 99965.000 106234.000 108131.000 110131.000 111132.000 116815.000 121761.000 122419.000 
query 1 nn's (64503): 3716291 (7710) 3996839 (7694) 7577481 (7676) 8499244 (7681) 3909984 (7619) 2780695 (7631) 5907695 (7756) 9025729 (7883) 731305 (7865) 5345487 (7835) 
     dis: 	74379.000 75371.000 82264.000 85032.000 85324.000 91976.000 94195.000 94645.000 96744.000 98683.000 
query 2 nn's (7601): 8635193 (4483) 8509795 (4438) 7912354 (4692) 330498 (4711) 4770809 (4663) 9174606 (4542) 5456620 (4654) 2604943 (4464) 2321268 (4568) 5608334 (4514) 
     dis: 	57831.000 66459.000 69132.000 69940.000 71143.000 76816.000 80719.000 81323.000 82007.000 82091.000 
query 3 nn's (7900): 7749958 (3697) 5078017 (3684) 5185015 (3869) 3313486 (3800) 8273818 (3640) 2114046 (3654) 9198105 (3818) 536836 (3856) 2936066 (3791) 4171561 (3901) 
     dis: 	8122.000 17256.000 18363.000 19021.000 20384.000 21815.000 22036.000 25581.000 26110.000 28359.000 
query 4 nn's (4420): 7828698 (72674) 9460939 (72852) 5596028 (72610) 8278850 (72598) 1224984 (72808) 6418324 (72587) 8843148 (72756) 1086381 (72850) 3296511 (72701) 5622590 (72732) 
     dis: 	116275.000 118333.000 120825.000 123681.000 124714.000 124836.000 125434.000 128537.000 131459.000 132102.000 
[ 3021.759s ] *** Query time: 18.384
qps: 543.937
 *** acorn recall 
efs:40
acorn get 35417 postive res from 100000 results, recall@10:0.354
recall dist(10% per bucket): 0.215 0.091 0.102 0.113 0.107 0.105 0.089 0.072 0.056 0.034 0.017 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3027.775s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 1514582
ndis: 0
nreorder: 0
average distance computations per query: 151.458
[ 3027.775s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_300_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_300_1_100000_random_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 40 128"
	User time (seconds): 2947.27
	System time (seconds): 71.68
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 50:29.16
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114642620
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 6
	Minor (reclaiming a frame) page faults: 32605645
	Voluntary context switches: 43668
	Involuntary context switches: 1523
	Swaps: 0
	File system inputs: 894024
	File system outputs: 56
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 14:05
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_400_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_400_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 40 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.225s ] Loaded metadata, 10000000 attr's found
[ 1.225s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.228s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_400_1_100000_random.json
[ 1.231s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_400_1_100000_random_10.json
[ 1.242s ] Loaded ground truth, gt_size: 10
[ 1.242s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.74 (867443801)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824510956)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959832)
   3. nb of reciprocal neighbors: 101.32
   4. nb of neighbors that are also neighbor-of-neighbors: 967.27 (241779756)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 937.33 (5822688)
   3. nb of reciprocal neighbors: 670.04
   4. nb of neighbors that are also neighbor-of-neighbors: 936.86 (5819766)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 131.58 (18421)
   3. nb of reciprocal neighbors: 129.71
   4. nb of neighbors that are also neighbor-of-neighbors: 131.07 (18350)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999555 nodes
	level 1: 249955 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2684.244s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 40
selectivity: 0.004
[ 3096.840s ] Query results (vector ids, then distances):
query 0 nn's (2310): 578867 (2476) 9823129 (2499) 1604819 (2475) 5826792 (2456) 1813619 (2534) 3190547 (2522) 844119 (2420) 4660189 (2480) 578809 (2592) 7979924 (2436) 
     dis: 	80841.000 90832.000 101413.000 102086.000 102284.000 104257.000 104500.000 107106.000 108797.000 108816.000 
query 1 nn's (2709): 5254261 (23886) 7856921 (23715) 4135481 (23704) 6140132 (23883) 2249685 (23891) 8199976 (23719) 5046775 (23698) 5778646 (23931) 3846925 (23986) 2404579 (23765) 
     dis: 	63867.000 80459.000 81010.000 83248.000 84606.000 86753.000 88931.000 89394.000 89885.000 90933.000 
query 2 nn's (23653): 3923235 (64295) 5546020 (64134) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	177517.000 179379.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (24052): 1782182 (90295) 6362628 (90403) 6352222 (90397) 3922451 (90374) 1667446 (90563) 5648192 (90545) 2448907 (90539) 9966794 (90533) 9373453 (90465) 5091898 (90527) 
     dis: 	26242.000 28153.000 30107.000 30591.000 30795.000 32466.000 34816.000 34931.000 39207.000 43508.000 
query 4 nn's (64025): 9353798 (42619) 1417456 (42485) 340641 (42390) 3309263 (42323) 7569563 (42644) 1135787 (42543) 5698837 (42593) 6162344 (42575) 409386 (42512) 4413421 (42402) 
     dis: 	100266.000 104284.000 116214.000 116344.000 117749.000 121751.000 122574.000 122884.000 123326.000 123777.000 
[ 3096.840s ] *** Query time: 55.614
qps: 179.810
 *** acorn recall 
efs:40
acorn get 48652 postive res from 100000 results, recall@10:0.487
recall dist(10% per bucket): 0.117 0.050 0.070 0.092 0.104 0.121 0.118 0.110 0.100 0.075 0.043 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3103.299s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 2023178
ndis: 0
nreorder: 0
average distance computations per query: 202.318
[ 3103.299s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_400_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_400_1_100000_random_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 40 128"
	User time (seconds): 2983.41
	System time (seconds): 111.65
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 51:45.82
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114638524
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 2
	Minor (reclaiming a frame) page faults: 40943664
	Voluntary context switches: 46542
	Involuntary context switches: 4288
	Swaps: 0
	File system inputs: 1918232
	File system outputs: 56
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 16:04
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_500_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_500_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 40 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.229s ] Loaded metadata, 10000000 attr's found
[ 1.229s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.231s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_500_1_100000_random.json
[ 1.234s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_500_1_100000_random_10.json
[ 1.245s ] Loaded ground truth, gt_size: 10
[ 1.245s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.74 (867443801)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824510956)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959832)
   3. nb of reciprocal neighbors: 101.32
   4. nb of neighbors that are also neighbor-of-neighbors: 967.27 (241779756)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 937.33 (5822688)
   3. nb of reciprocal neighbors: 670.04
   4. nb of neighbors that are also neighbor-of-neighbors: 936.86 (5819766)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 131.58 (18421)
   3. nb of reciprocal neighbors: 129.71
   4. nb of neighbors that are also neighbor-of-neighbors: 131.07 (18350)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999555 nodes
	level 1: 249955 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2703.693s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 40
selectivity: 0.005
[ 3134.726s ] Query results (vector ids, then distances):
query 0 nn's (23240): 8031075 (23431) 6025385 (23339) 5628617 (23560) 5931273 (23547) 9208730 (23589) 2914049 (23337) 37362 (23394) 8906920 (23474) 8590115 (23702) 977491 (23297) 
     dis: 	91152.000 103394.000 105705.000 106088.000 109177.000 109733.000 110608.000 112790.000 114623.000 115396.000 
query 1 nn's (23739): 8857836 (86643) 2077396 (86724) 7523342 (87042) 6363708 (86935) 4321977 (86855) 1116609 (86888) 9131855 (87082) 5234937 (86897) 1448692 (87058) 4313700 (87075) 
     dis: 	65552.000 65598.000 69035.000 70710.000 74235.000 75355.000 77123.000 81577.000 84199.000 86934.000 
query 2 nn's (86638): 8068558 (3605) 2800256 (3943) 1482128 (3797) 1213154 (3674) 4378993 (3989) 1458512 (4014) 2526681 (3938) 4192813 (3845) 122085 (3670) 475996 (3749) 
     dis: 	53350.000 59276.000 64294.000 68386.000 69422.000 69585.000 70683.000 71786.000 72781.000 73083.000 
query 3 nn's (87137): 7301436 (87758) 4673685 (87740) 8081932 (87465) 4104595 (87586) 5255438 (87585) 1952217 (87397) 771303 (87436) 9803556 (87542) 3872385 (87718) 7070340 (87603) 
     dis: 	7394.000 10176.000 14399.000 14412.000 16388.000 16501.000 17494.000 18060.000 18686.000 18857.000 
query 4 nn's (3598): 359595 (77567) 7674023 (77388) 9123370 (77558) 8165661 (77613) 102892 (77400) 897069 (77483) 9317347 (77172) 9693594 (77415) 1390139 (77481) 6895571 (77227) 
     dis: 	118467.000 118775.000 121509.000 124643.000 124920.000 128867.000 131326.000 132593.000 133362.000 134346.000 
[ 3134.726s ] *** Query time: 64.506
qps: 155.025
 *** acorn recall 
efs:40
acorn get 57430 postive res from 100000 results, recall@10:0.574
recall dist(10% per bucket): 0.074 0.030 0.047 0.069 0.093 0.110 0.129 0.129 0.132 0.114 0.074 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3141.463s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 2520334
ndis: 0
nreorder: 0
average distance computations per query: 252.033
[ 3141.463s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_500_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_500_1_100000_random_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 40 128"
	User time (seconds): 3006.67
	System time (seconds): 126.33
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 52:23.54
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114639544
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 7
	Minor (reclaiming a frame) page faults: 59039533
	Voluntary context switches: 48733
	Involuntary context switches: 4398
	Swaps: 0
	File system inputs: 1934688
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 18:01
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_600_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_600_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 40 
dim: 128
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.238s ] Loaded metadata, 10000000 attr's found
[ 1.238s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 1.241s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_600_1_100000_random.json
[ 1.243s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_600_1_100000_random_10.json
[ 1.255s ] Loaded ground truth, gt_size: 10
[ 1.255s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
========= METADATA =======
	* cumulative max num neighbors per level
		indx 0: 0
		indx 1: 124
		indx 2: 1124
		indx 3: 2124
		indx 4: 3124
		indx 5: 4124
	* level probabilities
		level 0: 0.975000
		level 1: 0.024375
		level 2: 0.000609
		level 3: 0.000015
		level 4: 0.000000
		level 5: 0.000000
	* efConstruction: 1000
	* efSearch: 16
	* max_level: 4
	* entry_point: 1940918
	* gamma: 25
========= LEVEL STATS OF ACORN =======
========= LEVEL 0 =======
* stats on level 0, max 124 neighbors per vertex:
   1. nb of nodes: 10000000
   2. neighbors per node: 86.74 (867443801)
   3. nb of reciprocal neighbors: 61.08
   4. nb of neighbors that are also neighbor-of-neighbors: 82.45 (824510956)
========= LEVEL 1 =======
* stats on level 1, max 1000 neighbors per vertex:
   1. nb of nodes: 249960
   2. neighbors per node: 1000.00 (249959832)
   3. nb of reciprocal neighbors: 101.32
   4. nb of neighbors that are also neighbor-of-neighbors: 967.27 (241779756)
========= LEVEL 2 =======
* stats on level 2, max 1000 neighbors per vertex:
   1. nb of nodes: 6212
   2. neighbors per node: 937.33 (5822688)
   3. nb of reciprocal neighbors: 670.04
   4. nb of neighbors that are also neighbor-of-neighbors: 936.86 (5819766)
========= LEVEL 3 =======
* stats on level 3, max 1000 neighbors per vertex:
   1. nb of nodes: 140
   2. neighbors per node: 131.58 (18421)
   3. nb of reciprocal neighbors: 129.71
   4. nb of neighbors that are also neighbor-of-neighbors: 131.07 (18350)
========= LEVEL 4 =======
* stats on level 4, max 1000 neighbors per vertex:
   1. nb of nodes: 3
   2. neighbors per node: 2.00 (6)
   3. nb of reciprocal neighbors: 2.00
   4. nb of neighbors that are also neighbor-of-neighbors: 2.00 (6)
METADATA VEC for number nodes per level
	level 0: 9999555 nodes
	level 1: 249955 nodes
	level 2: 6212 nodes
	level 3: 140 nodes
	level 4: 3 nodes
	level 5: 0 nodes
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2669.610s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 40
selectivity: 0.006
[ 3042.870s ] Query results (vector ids, then distances):
query 0 nn's (53561): 9409479 (53603) 3366295 (53986) 4056305 (53810) 7835503 (53994) 9934561 (53675) 5014849 (54135) 2828720 (53831) 1973354 (53983) 8997084 (53636) 1053287 (53877) 
     dis: 	82688.000 88619.000 93108.000 95210.000 99218.000 99975.000 101279.000 102342.000 102557.000 104280.000 
query 1 nn's (54160): 1346170 (8078) 9643506 (8041) 7572692 (7996) 3716291 (7710) 3996839 (7694) 8500402 (7579) 3423010 (7592) 7577481 (7676) 8499244 (7681) 3909984 (7619) 
     dis: 	56324.000 61991.000 74068.000 74379.000 75371.000 78635.000 79844.000 82264.000 85032.000 85324.000 
query 2 nn's (7537): 6757010 (32419) 1883447 (32456) 6005722 (32578) 8415105 (32282) 2414928 (32539) 4278769 (32271) 2284580 (32263) 3173474 (32228) 3423038 (32405) 1819941 (32058) 
     dis: 	61808.000 63881.000 63923.000 67665.000 67775.000 68330.000 72005.000 73293.000 73349.000 75819.000 
query 3 nn's (8136): 3278687 (20238) 9166 (20530) 1391991 (20268) 5109723 (20631) 8386530 (20268) 430134 (20429) 2515467 (20181) 6365231 (20234) 8513887 (20167) 7943427 (20144) 
     dis: 	7183.000 8830.000 9540.000 11444.000 11509.000 12043.000 12594.000 13919.000 14041.000 16358.000 
query 4 nn's (31990): 139002 (25306) 4913897 (25124) 2289309 (25219) 9751956 (25634) 3162364 (25499) 95039 (25443) 801493 (25132) 2429889 (25554) 28144 (25433) 2831501 (25676) 
     dis: 	106444.000 112554.000 113992.000 114945.000 116867.000 117096.000 117515.000 117861.000 118837.000 119731.000 
[ 3042.870s ] *** Query time: 14.121
qps: 708.181
 *** acorn recall 
efs:40
acorn get 63744 postive res from 100000 results, recall@10:0.637
recall dist(10% per bucket): 0.052 0.020 0.037 0.050 0.075 0.095 0.124 0.139 0.149 0.146 0.114 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[3047.674s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 2994228
ndis: 0
nreorder: 0
average distance computations per query: 299.423
[ 3047.674s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/qrangesel_600_1_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_1_100000_random/sif_gt_sel_600_1_100000_random_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 40 128"
	User time (seconds): 2965.53
	System time (seconds): 73.08
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 50:49.06
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 114635448
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1
	Minor (reclaiming a frame) page faults: 30366643
	Voluntary context switches: 43527
	Involuntary context switches: 2204
	Swaps: 0
	File system inputs: 1801088
	File system outputs: 32
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
