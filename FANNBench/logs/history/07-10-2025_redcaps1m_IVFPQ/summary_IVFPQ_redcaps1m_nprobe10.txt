Start time: 04:44
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 100
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_100.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_256
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.079s ] Loaded metadata, 1000000 attr's found
[ 0.080s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.090s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.092s ] Loaded 10000 redcaps1m queries
[ 0.158s ] Loaded ground truth, gt_size: 100
[ 0.158s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.077s ] Searching the 100 nearest neighbors of 10000 vectors in the index
selectivity: 0.500
[ 23.335s ] Query results (vector ids, then distances):
query 0 nn's (1540574211, 1590004802): 727106 (1557359735) 562528 (1586530455) 247269 (1563268918) 64073 (1552081912) 966838 (1570564531) 84548 (1557155880) 302187 (1566023840) 316095 (1551987403) 997247 (1547217917) 334544 (1563704708) 465841 (1541316839) 650558 (1552134375) 309200 (1583866074) 363324 (1588150617) 988753 (1543862249) 91712 (1562697586) 596166 (1579563279) 606467 (1568763473) 708925 (1576703816) 927993 (1565326081) 268357 (1575827166) 533175 (1575258274) 472918 (1564281975) 318225 (1582255095) 131965 (1556466636) 602879 (1548953318) 686231 (1566039123) 493307 (1561727055) 679931 (1540740143) 909887 (1573250307) 345358 (1552161794) 517669 (1549396737) 174023 (1555779163) 154883 (1581301418) 399187 (1587938124) 540453 (1573344926) 331521 (1564901683) 385435 (1589983348) 323370 (1580598904) 433231 (1565823839) 602404 (1541391641) 486165 (1570286389) 46879 (1559067774) 295694 (1561539309) 804923 (1580916714) 526743 (1589814030) 373982 (1587320434) 448032 (1579574671) 184145 (1577120906) 704461 (1567652497) 626195 (1575674868) 509649 (1563988216) 965396 (1589114636) 666189 (1552003079) 662170 (1560280718) 237835 (1578641010) 44577 (1583002559) 929621 (1589242675) 645492 (1573441517) 484885 (1563438472) 145589 (1589118962) 243123 (1588045918) 676096 (1574343632) 437624 (1567202500) 77010 (1578108291) 417314 (1551548133) 440172 (1584059747) 595179 (1548634558) 998126 (1589375632) 743765 (1543717382) 46465 (1586063219) 30638 (1557761632) 407702 (1557507743) 153889 (1553833192) 144940 (1577197701) 766078 (1556381824) 617850 (1570983550) 747726 (1579041664) 495102 (1544389721) 227118 (1548676233) 149044 (1573803326) 603131 (1545731037) 273893 (1565706467) 780990 (1586911069) 805698 (1585157295) 347976 (1572245541) 563448 (1555181568) 201672 (1572874976) 139370 (1568474848) 432022 (1582770915) 940240 (1564039269) 843746 (1557509528) 866187 (1581565128) 866249 (1560824182) 375289 (1569258017) 738372 (1576063966) 275545 (1578735911) 324437 (1584630140) 450011 (1562883439) 593718 (1570415161) 
     dis: 	0.624 0.634 0.667 0.745 0.772 0.775 0.775 0.777 0.788 0.795 0.799 0.803 0.805 0.806 0.822 0.837 0.838 0.842 0.854 0.864 0.868 0.869 0.873 0.877 0.885 0.886 0.888 0.894 0.896 0.896 0.896 0.897 0.900 0.905 0.906 0.906 0.907 0.908 0.910 0.910 0.916 0.917 0.917 0.919 0.920 0.921 0.921 0.922 0.925 0.927 0.928 0.931 0.934 0.936 0.938 0.938 0.939 0.940 0.940 0.942 0.942 0.944 0.944 0.946 0.948 0.948 0.951 0.952 0.952 0.954 0.954 0.954 0.955 0.957 0.960 0.961 0.961 0.964 0.964 0.964 0.965 0.969 0.969 0.970 0.970 0.971 0.971 0.972 0.973 0.973 0.973 0.975 0.975 0.976 0.976 0.976 0.976 0.976 0.977 0.977 
query 1 nn's (1502815998, 1574739098): 741325 (1559616195) 666880 (1555641433) 979250 (1523372340) 622447 (1532959985) 427146 (1514695882) 803332 (1530141155) 428754 (1560720094) 110189 (1507487399) 139424 (1535633696) 284310 (1570817806) 964018 (1566639637) 939001 (1521863047) 928093 (1551573119) 795520 (1549367888) 421889 (1509323403) 329834 (1552801370) 7931 (1531328513) 994014 (1549410785) 459927 (1570948131) 979295 (1567526425) 848169 (1567967943) 997966 (1560111653) 832389 (1509148358) 661716 (1569475757) 104425 (1517937828) 710350 (1543853777) 848037 (1547627912) 399497 (1531827001) 866328 (1550960142) 85059 (1560480821) 195548 (1519575345) 630058 (1510985967) 671340 (1545504039) 577336 (1551645910) 743973 (1565255174) 326649 (1542991586) 709969 (1549840943) 964128 (1566424023) 408156 (1550161639) 272839 (1567350368) 178695 (1539523827) 857939 (1506859251) 226358 (1565225638) 885087 (1525644326) 925374 (1547210027) 395948 (1572268410) 721597 (1560048937) 544577 (1529068259) 925657 (1569885810) 271263 (1523394425) 324349 (1565636095) 620586 (1542847663) 55881 (1516654636) 837200 (1517967912) 107066 (1564445038) 557922 (1542237514) 169444 (1559524323) 795310 (1572108672) 784003 (1503860978) 418536 (1508889764) 320719 (1526407679) 935736 (1516385240) 770454 (1561685089) 769260 (1570050053) 80871 (1546322460) 489550 (1561300577) 584466 (1558116296) 816247 (1563724766) 135640 (1562247065) 62978 (1548008868) 785418 (1513559759) 687772 (1567207126) 916706 (1560980031) 855763 (1569114081) 244515 (1565195570) 288542 (1507728447) 77283 (1545499206) 811301 (1551198823) 82481 (1518972141) 672841 (1520507128) 417828 (1564258459) 750270 (1568905945) 1519 (1561555264) 384623 (1530652501) 116279 (1540745988) 388764 (1538816911) 86484 (1550619400) 344524 (1553054923) 242179 (1574602885) 213143 (1530845306) 885260 (1562875914) 232066 (1563834787) 366937 (1530677494) 722531 (1562614185) 865350 (1562057425) 722158 (1557686757) 958421 (1560503853) 678677 (1525640581) 785513 (1568160267) 485598 (1553564926) 
     dis: 	0.099 0.100 0.101 0.103 0.105 0.106 0.108 0.110 0.111 0.111 0.112 0.113 0.113 0.113 0.113 0.113 0.114 0.114 0.115 0.115 0.115 0.116 0.117 0.117 0.117 0.117 0.118 0.118 0.118 0.118 0.118 0.118 0.119 0.119 0.119 0.120 0.120 0.120 0.120 0.121 0.121 0.122 0.122 0.122 0.122 0.122 0.122 0.122 0.123 0.123 0.124 0.124 0.125 0.125 0.125 0.126 0.126 0.126 0.126 0.126 0.127 0.127 0.127 0.127 0.128 0.128 0.128 0.129 0.129 0.129 0.129 0.129 0.129 0.130 0.130 0.130 0.130 0.130 0.130 0.130 0.130 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.131 0.132 0.132 0.132 0.132 0.132 
query 2 nn's (1565134124, 1606255797): 964377 (1605131892) 306439 (1575579764) 757728 (1605423787) 75885 (1601934153) 445298 (1589162214) 71515 (1570882811) 771849 (1570744783) 903106 (1586146246) 328504 (1595799020) 792564 (1597961764) 498270 (1586402085) 751228 (1585488453) 530996 (1598262380) 494541 (1567102094) 737868 (1571342287) 435452 (1574701387) 837851 (1605837809) 929527 (1587699711) 971858 (1600907724) 507734 (1605297824) 800558 (1578206579) 633139 (1583107000) 610678 (1584998424) 952981 (1588948381) 919763 (1580427352) 589140 (1597778814) 24425 (1584502238) 627502 (1584624938) 33572 (1567059144) 879865 (1599868306) 253786 (1598570829) 230054 (1603647309) 870630 (1568931614) 728355 (1598234783) 976907 (1594577610) 136876 (1579879526) 509068 (1582362871) 341373 (1582339286) 491378 (1598099263) 910005 (1589155576) 844350 (1601083260) 88997 (1597461015) 985107 (1565328361) 74992 (1573424430) 812326 (1580129904) 625576 (1604050293) 319345 (1568052528) 645543 (1585948706) 557020 (1584521629) 660131 (1601954615) 184796 (1580838071) 470869 (1582932711) 14154 (1594153934) 915391 (1601243129) 826279 (1597417912) 304775 (1575151723) 578528 (1604204574) 201205 (1586171256) 459595 (1582500502) 490170 (1604285031) 435592 (1590078863) 962379 (1591499930) 620162 (1566431760) 546876 (1605386607) 310380 (1597000036) 780551 (1599435257) 198935 (1603661610) 356369 (1600690480) 290482 (1589215284) 63845 (1588094783) 852066 (1602089962) 27739 (1577559718) 653763 (1586634965) 916423 (1591800043) 191026 (1575282024) 652018 (1594040809) 600470 (1584241727) 699521 (1578031471) 382759 (1576615596) 736467 (1580426331) 309618 (1575469598) 61515 (1591564032) 793716 (1566066816) 448037 (1570375999) 776456 (1599940494) 889497 (1574301401) 599464 (1584493573) 765776 (1567939011) 366420 (1585364365) 971273 (1605483717) 994858 (1584120281) 19189 (1565787253) 476379 (1590366484) 801949 (1571627388) 845994 (1567420709) 782944 (1576643215) 77279 (1582988514) 730117 (1598494770) 976074 (1568415904) 322210 (1590326975) 
     dis: 	0.225 0.237 0.237 0.254 0.261 0.262 0.264 0.269 0.271 0.273 0.276 0.276 0.276 0.277 0.277 0.278 0.279 0.280 0.282 0.282 0.283 0.283 0.284 0.285 0.286 0.287 0.288 0.290 0.290 0.290 0.292 0.294 0.294 0.294 0.295 0.296 0.296 0.297 0.297 0.297 0.298 0.300 0.301 0.301 0.302 0.302 0.302 0.302 0.303 0.304 0.305 0.305 0.305 0.305 0.305 0.305 0.306 0.306 0.306 0.307 0.309 0.309 0.310 0.310 0.311 0.311 0.311 0.311 0.312 0.312 0.313 0.313 0.313 0.313 0.313 0.314 0.314 0.314 0.315 0.315 0.315 0.315 0.315 0.317 0.317 0.317 0.317 0.317 0.318 0.318 0.318 0.319 0.319 0.321 0.321 0.321 0.322 0.322 0.322 0.322 
query 3 nn's (1564977898, 1606128091): 889987 (1593644784) 783586 (1584449301) 124464 (1588791594) 640717 (1593715105) 595884 (1603585196) 306883 (1582504320) 456770 (1569878368) 110113 (1584365036) 108295 (1585156706) 758927 (1600115067) 879049 (1580410467) 269754 (1600944924) 170065 (1567980012) 469326 (1591653206) 555783 (1582924247) 725969 (1596031378) 226331 (1587219459) 671717 (1569449284) 345300 (1592195475) 899709 (1569431812) 174382 (1591143332) 910519 (1596209853) 225830 (1582762176) 800827 (1581281066) 989223 (1601168056) 43568 (1574027594) 391302 (1573059058) 397607 (1576582831) 472875 (1570825151) 638495 (1591051278) 799434 (1571614920) 479354 (1574296216) 882799 (1602614385) 301836 (1586460731) 17746 (1578159083) 931871 (1577236835) 684978 (1569892488) 533587 (1578734941) 567499 (1598482734) 430216 (1590828473) 100162 (1603446100) 247163 (1588394370) 808853 (1600624761) 309349 (1590795708) 418179 (1569261639) 412295 (1592051871) 135464 (1601302603) 222643 (1586742508) 332772 (1591201180) 694334 (1583158570) 553746 (1565242336) 242265 (1582348130) 923128 (1584271014) 807512 (1565479561) 237881 (1577944076) 935542 (1579374712) 631191 (1576790924) 430670 (1566812498) 706869 (1571407578) 315020 (1570876084) 37631 (1569700468) 130248 (1584742028) 20577 (1567996955) 850509 (1589330635) 642929 (1568418148) 602682 (1582950625) 344149 (1568144323) 548723 (1598996868) 613946 (1597014183) 952161 (1574301200) 434098 (1596184813) 601576 (1591122396) 448941 (1604273377) 835687 (1592498554) 778596 (1565323092) 26753 (1603235312) 101063 (1595050204) 449855 (1589014738) 693433 (1599313479) 58054 (1574730936) 67641 (1589418579) 249126 (1573933145) 615834 (1599922707) 361068 (1575261343) 190567 (1589421329) 107648 (1592578099) 101626 (1592274941) 305649 (1596841294) 843147 (1592295601) 622606 (1595561944) 764357 (1586539061) 289872 (1566343069) 874136 (1585671492) 94707 (1589396524) 48330 (1581407630) 769087 (1573622852) 623185 (1581588604) 132008 (1578950863) 268380 (1583626170) 383377 (1592876562) 
     dis: 	0.402 0.416 0.445 0.452 0.456 0.481 0.497 0.500 0.507 0.511 0.513 0.514 0.515 0.517 0.517 0.520 0.520 0.524 0.527 0.527 0.527 0.528 0.530 0.532 0.532 0.533 0.534 0.537 0.538 0.541 0.542 0.542 0.543 0.544 0.544 0.544 0.545 0.545 0.547 0.547 0.549 0.551 0.552 0.552 0.553 0.553 0.554 0.554 0.555 0.559 0.559 0.559 0.560 0.560 0.561 0.561 0.561 0.561 0.561 0.562 0.562 0.564 0.565 0.565 0.566 0.566 0.568 0.568 0.569 0.570 0.571 0.572 0.572 0.573 0.573 0.573 0.573 0.574 0.574 0.575 0.576 0.577 0.580 0.581 0.582 0.582 0.582 0.583 0.583 0.584 0.584 0.584 0.585 0.585 0.585 0.586 0.588 0.588 0.588 0.589 
query 4 nn's (1486429184, 1570175082): 582698 (1557087889) 959629 (1553076435) 279888 (1555515184) 46163 (1552605357) 754904 (1532757000) 68136 (1537086660) 231993 (1563749968) 700754 (1557101934) 54130 (1553866600) 589135 (1547166816) 789873 (1564175719) 929991 (1548794594) 455512 (1559505416) 834676 (1547757785) 59094 (1536774042) 403555 (1549502178) 565451 (1563280600) 222228 (1543263211) 902523 (1564343178) 969773 (1527858141) 18995 (1561278454) 351217 (1545147659) 861337 (1559160334) 979493 (1540438177) 143565 (1516103937) 282395 (1552886840) 511053 (1554404630) 573206 (1557940034) 732037 (1558530545) 507409 (1565232420) 655488 (1505816775) 51681 (1535136336) 173575 (1509173034) 500007 (1555794424) 584115 (1555479090) 285533 (1567392541) 569466 (1522175329) 148545 (1518097309) 760527 (1492818655) 244038 (1543691184) 367708 (1513407029) 464808 (1521378210) 923538 (1527525691) 235772 (1551117248) 490515 (1562711345) 101369 (1531669788) 440301 (1534385643) 850663 (1553673926) 921524 (1559055905) 709494 (1563922629) 596233 (1565428603) 604226 (1538444207) 831639 (1563684890) 991700 (1557260076) 243614 (1557773802) 472675 (1558466102) 383401 (1551173308) 148956 (1559619602) 879112 (1542488309) 4809 (1526640489) 488735 (1552857191) 804319 (1545081457) 349764 (1504390639) 481726 (1488335210) 402334 (1546055700) 368404 (1565871447) 151023 (1491761955) 664967 (1556213298) 548112 (1516557766) 651595 (1563450222) 902566 (1549939577) 108425 (1566018231) 11638 (1560223046) 66709 (1556038949) 699783 (1532683504) 503133 (1568295660) 830726 (1545793853) 510943 (1565498173) 214285 (1534561001) 268573 (1554001664) 94664 (1538959216) 884068 (1536261602) 393712 (1555676834) 651432 (1554907170) 641662 (1564427480) 91548 (1545237504) 156739 (1503600606) 87978 (1560777171) 179763 (1562980446) 96345 (1488407461) 325148 (1554330508) 544657 (1547472912) 276788 (1546028674) 514616 (1511183004) 380398 (1510441007) 720233 (1568738716) 959456 (1555288254) 855122 (1548705861) 148903 (1557778187) 813936 (1567784216) 
     dis: 	0.261 0.293 0.298 0.299 0.300 0.304 0.307 0.307 0.308 0.311 0.312 0.315 0.316 0.316 0.317 0.320 0.323 0.324 0.325 0.325 0.327 0.327 0.327 0.328 0.330 0.331 0.333 0.334 0.334 0.335 0.335 0.337 0.338 0.340 0.341 0.343 0.343 0.344 0.346 0.347 0.350 0.350 0.350 0.350 0.352 0.352 0.353 0.354 0.354 0.354 0.357 0.359 0.360 0.361 0.362 0.363 0.364 0.364 0.365 0.366 0.368 0.368 0.369 0.369 0.369 0.370 0.371 0.372 0.373 0.373 0.373 0.374 0.374 0.374 0.374 0.375 0.375 0.376 0.376 0.376 0.376 0.377 0.378 0.378 0.378 0.378 0.378 0.379 0.379 0.379 0.379 0.379 0.379 0.380 0.382 0.382 0.383 0.383 0.383 0.383 
[ 23.336s ] *** Query time: 16.483
qps: 606.678
 *** ivfpq recall 
ivfpq get 788216 postive res from 1000000 results, recall@100:0.788
recall dist(10% per bucket): 0.000 0.002 0.010 0.027 0.049 0.078 0.111 0.147 0.187 0.383 0.006 
finished ivfpq index examples
[ 23.364s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 100 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_100.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_256 10 512"
	User time (seconds): 22.22
	System time (seconds): 0.78
	Percent of CPU this job got: 98%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:23.47
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 1346464
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1
	Minor (reclaiming a frame) page faults: 335702
	Voluntary context switches: 921
	Involuntary context switches: 87
	Swaps: 0
	File system inputs: 32272
	File system outputs: 32
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
