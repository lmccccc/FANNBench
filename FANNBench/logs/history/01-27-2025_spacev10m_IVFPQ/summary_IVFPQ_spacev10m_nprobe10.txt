Start time: 19:32
====================
START: running IVFPQ_INDEX_CONSTRUCTION, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs
attr file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
index file: /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64
dim: 192
partition_size: 64
train file: /mnt/data/mocheng/dataset/yfcc10m/train.fvecs
loaded base attributes, size:10000000
[ 0.718s ] Loaded attributions, 10000000 found
[ 0.718s ] Index Params -- d: 192, N: 10000000
ncentroids: 12649
====================Vectors====================

[ 0.718s ] Loading database
[ 5.963s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs
data loaded, with dim: 192, N=10000000
[ 5.963s ] Indexing database, size 10000000*192 from max 10000000
[ 5.963s ] Adding the vectors to the index
WARNING clustering 100000 points to 12649 centroids: please provide at least 493311 training points
train cost:0.047
index construction total cost:942.866
[ 942.866s ] Vectors added to  index
Index vectors added:10000000
====================Write Index================

[ 949.808s ] Wrote ivbfpq index to file: /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64
[949.808 s] -----DONE-----
[ 949.808s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_build spacev10m 10000000 10 128 /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64 192 64 /mnt/data/mocheng/dataset/yfcc10m/train.fvecs"
	User time (seconds): 83696.31
	System time (seconds): 76.52
	Percent of CPU this job got: 8818%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 15:49.97
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 9437148
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 3
	Minor (reclaiming a frame) page faults: 7930311
	Voluntary context switches: 4822914
	Involuntary context switches: 1468854
	Swaps: 0
	File system inputs: 560
	File system outputs: 1425832
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 01:17
====================
START: running TEST_IVFPQ, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/qrangesel_1000_1_100000_in_dist.json
gt file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/sif_gt_sel_1000_1_100000_in_dist_10.json
index file: /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64
nprobe: 10
dim: 192
loaded base attributes from:/mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 0.714s ] Loaded metadata, 10000000 attr's found
[ 0.714s ] Loading query vectors and attributes
query vecs data loaded, with dim: 192, nb=10000
[ 0.719s ] Loaded query vectors from /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
[ 0.720s ] Loaded 10000 spacev10m queries
[ 0.728s ] Loaded ground truth, gt_size: 10
[ 0.728s ] Index Params -- d: 192, N: 10000000
 load index size: 10000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.157s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 504.748s ] Query results (vector ids, then distances):
query 0 nn's (51111, 52111): 9266351 (51119) 650732 (51330) 2427833 (51682) 1741472 (52062) 8140362 (51496) 2390635 (52026) 2483624 (51802) 9101118 (51264) 3163065 (51137) 7402374 (51533) 
     dis: 	43456.102 47084.719 47167.891 47367.625 47464.125 47898.281 51999.168 52117.094 52413.906 52918.371 
query 1 nn's (24588, 25588): 4056736 (24969) 3481345 (25035) 6338457 (25045) 1711700 (24641) 2035250 (25432) 8496465 (24914) 9069058 (24660) 9009741 (24986) 3460884 (25278) 5964487 (25068) 
     dis: 	43445.973 47960.562 50931.422 51333.117 53788.348 54047.727 57327.879 58623.586 59108.969 59915.344 
query 2 nn's (62344, 63344): 7177617 (62433) 3674921 (62985) 8091170 (62831) 798434 (62637) 8768588 (62837) 1370019 (62437) 2556033 (62610) 3918866 (62424) 9027490 (63038) 6452061 (63076) 
     dis: 	42223.043 45696.559 48413.594 49354.551 51466.508 54408.980 55301.320 55441.547 55473.414 55605.344 
query 3 nn's (29217, 30217): 5565405 (29344) 4421559 (29265) 7402542 (30148) 9724475 (29878) 4082592 (30197) 9519664 (29805) 6433192 (30065) 5565859 (29515) 9344265 (29489) 6382606 (30010) 
     dis: 	40171.961 58634.789 62135.098 62644.391 63423.941 64018.480 64385.836 66030.781 66753.969 67460.820 
query 4 nn's (11691, 12691): 4913683 (12573) 3996078 (11775) 7175402 (12682) 8333810 (12690) 1459955 (11791) 3414877 (12093) 1198433 (12068) 2734717 (12579) 6827276 (11962) 6074730 (12128) 
     dis: 	30319.867 33875.797 36062.734 37969.750 40286.527 41214.309 42357.711 42391.430 43147.480 44041.469 
[ 504.748s ] *** Query time: 87.632
qps: 114.113
 *** ivfpq recall 
ivfpq get 544 postive res from 100000 results, recall@10:0.005
recall dist(10% per bucket): 0.947 0.052 0.001 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
finished ivfpq index examples
[ 504.750s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query spacev10m 10000000 10 1 /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/qrangesel_1000_1_100000_in_dist.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/sif_gt_sel_1000_1_100000_in_dist_10.json /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64 10 192"
	User time (seconds): 461.17
	System time (seconds): 46.48
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 8:27.68
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 51391968
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 2
	Minor (reclaiming a frame) page faults: 21814206
	Voluntary context switches: 10
	Involuntary context switches: 712
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 03:15
====================
START: running TEST_IVFPQ, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/qrangesel_1000_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/sif_gt_sel_1000_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_random_64
nprobe: 10
dim: 192
loaded base attributes from:/mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 0.720s ] Loaded metadata, 10000000 attr's found
[ 0.720s ] Loading query vectors and attributes
query vecs data loaded, with dim: 192, nb=10000
[ 0.726s ] Loaded query vectors from /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
[ 0.727s ] Loaded 10000 spacev10m queries
[ 0.735s ] Loaded ground truth, gt_size: 10
[ 0.735s ] Index Params -- d: 192, N: 10000000
 load index size: 10000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 3.069s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 498.560s ] Query results (vector ids, then distances):
query 0 nn's (60460, 61459): 9080559 (60929) 3419784 (61105) 1874547 (61356) 4716803 (60983) 2641065 (60915) 7135093 (60998) 1255437 (60748) 3873761 (61048) 7164688 (60767) 5459247 (60579) 
     dis: 	44843.242 45021.797 45256.668 45640.773 49030.039 49692.121 49959.012 50074.145 50698.789 50829.562 
query 1 nn's (96515, 97514): 2858528 (96822) 2644470 (96674) 1918163 (97269) 1814403 (97345) 9988575 (96658) 199583 (96851) 6303489 (97496) 9674543 (97003) 3903781 (96917) 2394919 (96532) 
     dis: 	42757.055 46986.438 49282.117 51476.645 52338.648 54975.230 56587.188 57540.109 57813.992 58907.012 
query 2 nn's (82013, 83012): 9014009 (82578) 7781120 (82237) 935246 (82207) 4921009 (82297) 2253189 (82334) 9316100 (82730) 105721 (82623) 9858552 (82252) 1709039 (82943) 4307529 (83008) 
     dis: 	41511.988 47096.973 51621.586 51644.977 54264.824 55251.645 55274.578 56632.832 57612.945 58673.309 
query 3 nn's (78919, 79918): 3907723 (79857) 3549535 (79218) 7345399 (79119) 2806985 (79338) 6524397 (78977) 5384118 (79344) 172837 (79776) 4082592 (79537) 2077396 (79432) 3601151 (79011) 
     dis: 	36117.723 58446.855 59571.516 60283.051 61278.824 61726.602 63391.488 63423.941 64176.062 65659.047 
query 4 nn's (34041, 35040): 4358085 (34149) 2731040 (34443) 6327018 (34612) 7617271 (34438) 4085396 (34454) 2311480 (34857) 6816771 (34604) 9002616 (35021) 7120249 (34936) 7263534 (34947) 
     dis: 	33070.551 35043.523 36114.953 36134.719 37149.219 37644.914 38179.828 38304.078 38836.238 39452.172 
[ 498.560s ] *** Query time: 85.607
qps: 116.813
 *** ivfpq recall 
ivfpq get 61718 postive res from 100000 results, recall@10:0.617
recall dist(10% per bucket): 0.006 0.026 0.055 0.076 0.100 0.115 0.133 0.135 0.151 0.145 0.058 
finished ivfpq index examples
[ 498.562s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query spacev10m 10000000 10 1 /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/qrangesel_1000_1_100000_random.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_random/sif_gt_sel_1000_1_100000_random_10.json /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_random_64 10 192"
	User time (seconds): 457.00
	System time (seconds): 43.96
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 8:21.80
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 51462056
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 20842719
	Voluntary context switches: 3301
	Involuntary context switches: 901
	Swaps: 0
	File system inputs: 162696
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:13
====================
START: running TEST_IVFPQ, sift data --

dataset: spacev10m
N: 10000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
qrange file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/qrangesel_1000_1_100000_out_dist.json
gt file: /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/sif_gt_sel_1000_1_100000_out_dist_10.json
index file: /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64
nprobe: 10
dim: 192
loaded base attributes from:/mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json
[ 0.773s ] Loaded metadata, 10000000 attr's found
[ 0.773s ] Loading query vectors and attributes
query vecs data loaded, with dim: 192, nb=10000
[ 0.777s ] Loaded query vectors from /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs
[ 0.779s ] Loaded 10000 spacev10m queries
[ 0.786s ] Loaded ground truth, gt_size: 10
[ 0.786s ] Index Params -- d: 192, N: 10000000
 load index size: 10000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 3.264s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.000
[ 88.224s ] Query results (vector ids, then distances):
query 0 nn's (100, 100): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (89, 89): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (18, 18): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (10, 10): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (96, 96): -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
[ 88.224s ] *** Query time: 9.101
qps: 1098.777
 *** ivfpq recall 
ivfpq get 999 postive res from 100000 results, recall@10:0.010
recall dist(10% per bucket): 0.904 0.091 0.004 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
finished ivfpq index examples
[ 88.226s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query spacev10m 10000000 10 1 /mnt/data/mocheng/dataset/yfcc10m/base10M.fvecs /mnt/data/mocheng/dataset/yfcc10m/query10k.fvecs /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/attr_sel_1_100000_dist.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/qrangesel_1000_1_100000_out_dist.json /mnt/data/mocheng/dataset/yfcc10m/label/sel_1_100000_dist/sif_gt_sel_1000_1_100000_out_dist_10.json /mnt/data/mocheng/dataset/yfcc10m/ivfpq/index/index_ivfpq_sel_1_100000_dist_64 10 192"
	User time (seconds): 86.07
	System time (seconds): 1.47
	Percent of CPU this job got: 98%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:28.47
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 1618856
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 441663
	Voluntary context switches: 4903
	Involuntary context switches: 136
	Swaps: 0
	File system inputs: 72152
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
