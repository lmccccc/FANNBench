Start time: 08:09
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: spacev10m
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_10000_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_10000_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 10 
dim: 100
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.281s ] Loaded metadata, 10000000 attr's found
[ 1.281s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 1.283s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_10000_1_100000_random.json
[ 1.286s ] Loaded 10000 spacev10m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_10000_1_100000_random_10.json
[ 1.297s ] Loaded ground truth, gt_size: 10
[ 1.297s ] Index Params -- d: 100, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 9637.127MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 9999534 nodes
level 1 : 249956 nodes
level 2 : 6211 nodes
level 3 : 140 nodes
level 4 : 3 nodes
level 5 : 0 nodes
Total edge:10255844
Average degree per layer:1709307.333
node size:10000000
Average degree:149.631
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 12.176s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 10
selectivity: 0.100
[ 456.256s ] Query results (vector ids, then distances):
query 0 nn's (40856): 606211 (46345) 6583311 (47922) 3082748 (43400) 38473 (46733) 8997960 (41694) 8538301 (43948) 7007393 (50612) 6547416 (46965) 2433318 (41182) 244510 (41564) 
     dis: 	5333.000 6338.000 6920.000 7027.000 7191.000 7544.000 7710.000 7882.000 8146.000 8194.000 
query 1 nn's (50855): 6693881 (28141) 6631934 (28922) 913237 (31716) 2400979 (32818) 1259440 (29909) 1580619 (31013) 6716625 (33472) 6825634 (34589) 4952577 (25638) 1010768 (32832) 
     dis: 	8318.000 9175.000 9300.000 10345.000 11032.000 11116.000 11253.000 11414.000 11430.000 11617.000 
query 2 nn's (25003): 5423341 (53232) 5736786 (58738) 1193323 (60470) 8263700 (53012) 1566478 (61581) 8141681 (61843) 6353647 (55287) 8793851 (57657) 1792128 (61455) 5630657 (58387) 
     dis: 	8500.000 14438.000 14703.000 14789.000 15452.000 15497.000 15873.000 16217.000 16281.000 16334.000 
query 3 nn's (35002): 3554434 (25036) 3787993 (28927) 2047471 (29467) 5041302 (28077) 6462625 (26730) 2406313 (31512) 2605021 (27817) 973000 (25306) 8768561 (27492) 8448447 (22710) 
     dis: 	11958.000 12101.000 12269.000 12681.000 12818.000 12937.000 12951.000 13028.000 13084.000 13293.000 
query 4 nn's (52136): 2038833 (53914) 6789739 (61948) 1444782 (58902) 8641215 (59349) 9407510 (57340) 1071436 (56465) 4734386 (57789) 7003644 (54071) 7921516 (63604) 3510502 (59384) 
     dis: 	6330.000 6812.000 6837.000 7009.000 7052.000 7080.000 7165.000 7191.000 7197.000 7293.000 
[ 456.257s ] *** Query time: 3.283
qps: 3045.809
 *** acorn recall 
efs:10
acorn get 44096 postive res from 100000 results, recall@10:0.441
recall dist(10% per bucket): 0.254 0.086 0.068 0.060 0.059 0.054 0.061 0.066 0.078 0.094 0.120 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[461.230s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 6014398
ndis: 0
nreorder: 0
average distance computations per query: 601.440
[ 461.230s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query spacev10m 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_10000_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_10000_1_100000_random_10.json /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 10 100"
	User time (seconds): 403.34
	System time (seconds): 59.08
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 7:42.43
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 113550000
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1
	Minor (reclaiming a frame) page faults: 30783586
	Voluntary context switches: 3
	Involuntary context switches: 315
	Swaps: 0
	File system inputs: 0
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 08:40
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: spacev10m
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs
query file: /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
attr file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
qrange file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_50000_1_100000_random.json
gt file: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_50000_1_100000_random_10.json
index file: /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64
ef_search: 10 
dim: 100
metadata or vector loaded from json, size: 10000000
loaded base attributes from:/mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json
[ 1.269s ] Loaded metadata, 10000000 attr's found
[ 1.269s ] Loading query vectors and attributes
query vecs data loaded, with dim: 100, nb=10000
[ 1.271s ] Loaded query vectors from /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_50000_1_100000_random.json
[ 1.273s ] Loaded 10000 spacev10m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_50000_1_100000_random_10.json
[ 1.285s ] Loaded ground truth, gt_size: 10
[ 1.285s ] Index Params -- d: 100, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 9637.127MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 9999534 nodes
level 1 : 249956 nodes
level 2 : 6211 nodes
level 3 : 140 nodes
level 4 : 3 nodes
level 5 : 0 nodes
Total edge:10255844
Average degree per layer:1709307.333
node size:10000000
Average degree:149.631
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 11.915s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 10
selectivity: 0.500
[ 637.024s ] Query results (vector ids, then distances):
query 0 nn's (40616): 1352077 (75218) 1300400 (68247) 525784 (86118) 606211 (46345) 1781760 (80354) 7509422 (86182) 8021837 (54227) 290760 (73276) 6583311 (47922) 1714233 (65633) 
     dis: 	3278.000 3455.000 5270.000 5333.000 5414.000 5894.000 6219.000 6292.000 6338.000 6491.000 
query 1 nn's (90615): 1027770 (59556) 3024255 (36040) 3545414 (44593) 9408428 (33214) 6693881 (28141) 1087257 (62343) 3843020 (54844) 1739613 (53800) 6945939 (60753) 6631934 (28922) 
     dis: 	4889.000 6351.000 7469.000 8315.000 8318.000 8514.000 8685.000 9038.000 9078.000 9175.000 
query 2 nn's (23827): 4574760 (37531) 5189301 (43405) 8005273 (37538) 4290437 (79182) 3524579 (49429) 8672246 (67919) 8167950 (64329) 4927764 (61896) 5932138 (71360) 8699363 (38066) 
     dis: 	3034.000 3368.000 3855.000 4555.000 5017.000 6310.000 6379.000 6596.000 6968.000 7268.000 
query 3 nn's (73826): 1208824 (37041) 1681561 (52434) 7375372 (33987) 1717763 (23291) 7664306 (35020) 2187959 (22411) 4153275 (14312) 8364431 (51130) 2272653 (58471) 4559449 (12184) 
     dis: 	7689.000 8422.000 9144.000 9696.000 9757.000 9826.000 9892.000 9931.000 9972.000 10145.000 
query 4 nn's (32197): 9788862 (69419) 73290 (81611) 9578545 (82305) 9193832 (94777) 6906799 (74949) 6001275 (76022) 2986049 (87137) 523134 (52660) 1546917 (87929) 7814617 (76949) 
     dis: 	6170.000 6268.000 6269.000 6455.000 6504.000 6630.000 6672.000 6702.000 6760.000 6818.000 
[ 637.024s ] *** Query time: 22.143
qps: 451.613
 *** acorn recall 
efs:10
acorn get 42423 postive res from 100000 results, recall@10:0.424
recall dist(10% per bucket): 0.351 0.062 0.049 0.041 0.040 0.039 0.047 0.055 0.066 0.091 0.159 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[647.245s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 7518838
ndis: 0
nreorder: 0
average distance computations per query: 751.884
[ 647.245s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query spacev10m 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/spacev10m/base10M.fvecs /mnt/data/mocheng/dataset/spacev10m/query10k.fvecs /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/attr_sel_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/qrangesel_50000_1_100000_random.json /mnt/data/mocheng/dataset/spacev10m/label/sel_1_100000_random/sif_gt_sel_50000_1_100000_random_10.json /mnt/data/mocheng/dataset/spacev10m/acorn/index/index_acorn_sel_1_100000_random_M40_ga25_Mb64 10 100"
	User time (seconds): 508.93
	System time (seconds): 140.32
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 10:49.28
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 113548984
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 67328945
	Voluntary context switches: 1
	Involuntary context switches: 1122
	Swaps: 0
	File system inputs: 0
	File system outputs: 40
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
