Start time: 01:22
N: 1000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
Traceback (most recent call last):
  File "utils/test_rii.py", line 87, in <module>
    assert(_N == N)
AssertionError
Start time: 01:24
N: 1000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 1000  N: 10000
Traceback (most recent call last):
  File "utils/test_rii.py", line 88, in <module>
    assert(_N == N)
AssertionError
Start time: 01:26
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 1000  N: 10000
Traceback (most recent call last):
  File "utils/test_rii.py", line 88, in <module>
    assert(_N == N)
AssertionError
Start time: 01:27
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 10000  N: 10000
get range dim: 100.0
groundtruth top K:  1.0
Traceback (most recent call last):
  File "utils/test_rii.py", line 100, in <module>
    assert(Ngt == Nq * K)
AssertionError
Start time: 01:28
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 10000  N: 10000
get range dim: 100.0
groundtruth top K:  1.0
ngt= 100  nq= 100  k= 10
Traceback (most recent call last):
  File "utils/test_rii.py", line 101, in <module>
    assert(Ngt == Nq * K)
AssertionError
Start time: 01:29
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 10000  N: 10000
get range dim: 100.0
groundtruth top K:  1.0
ngt= 100  nq= 100  k= 10
Traceback (most recent call last):
  File "utils/test_rii.py", line 101, in <module>
    assert(Ngt == Nq * K)
AssertionError
Start time: 01:44
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 10000  N: 10000
get range dim: 100.0
Traceback (most recent call last):
  File "utils/test_rii.py", line 96, in <module>
    gt = read_attr(groundtruth_file)
  File "/home/mocheng/code/FANNBench/utils/defination.py", line 107, in read_attr
    data = json.load(file)
  File "/home/mocheng/anaconda3/envs/py38/lib/python3.8/json/__init__.py", line 293, in load
    return loads(fp.read(),
  File "/home/mocheng/anaconda3/envs/py38/lib/python3.8/json/__init__.py", line 357, in loads
    return _default_decoder.decode(s)
  File "/home/mocheng/anaconda3/envs/py38/lib/python3.8/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/home/mocheng/anaconda3/envs/py38/lib/python3.8/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
json.decoder.JSONDecodeError: Expecting ',' delimiter: line 102 column 2 (char 690)
Start time: 01:48
N: 10000
dataset file: ../../dataset/siftsmall/siftsmall_base.fvecs
query file: ../../dataset/siftsmall/siftsmall_query.fvecs
train file: ../../dataset/siftsmall/siftsmall_learn.fvecs
attr file: ../../dataset/siftsmall/siftsmall_attr.json
query range file: ../../dataset/siftsmall/siftsmall_qrange.json
ground truth file: ../../dataset/siftsmall/siftsmall_gt_10.json
partition size M: 32
K: 10
get dataset size: 10000  d: 128
get query szie: 100
get train szie: 25000
_N: 10000  N: 10000
get range dim: 100.0
groundtruth top K:  10.0
ngt= 1000  nq= 100  k= 10
M: 32, Ks: 256, metric : <class 'numpy.uint8'>, code_dtype: l2
iter: 20, seed: 123
Training the subspace: 0 / 32
/home/mocheng/anaconda3/envs/py38/lib/python3.8/site-packages/scipy/cluster/vq.py:602: UserWarning: One of the clusters is empty. Re-run kmeans with a different initialization.
  warnings.warn("One of the clusters is empty. "
Training the subspace: 1 / 32
Training the subspace: 2 / 32
Training the subspace: 3 / 32
Training the subspace: 4 / 32
Training the subspace: 5 / 32
Training the subspace: 6 / 32
Training the subspace: 7 / 32
Training the subspace: 8 / 32
Training the subspace: 9 / 32
Training the subspace: 10 / 32
Training the subspace: 11 / 32
Training the subspace: 12 / 32
Training the subspace: 13 / 32
Training the subspace: 14 / 32
Training the subspace: 15 / 32
Training the subspace: 16 / 32
Training the subspace: 17 / 32
Training the subspace: 18 / 32
Training the subspace: 19 / 32
Training the subspace: 20 / 32
Training the subspace: 21 / 32
Training the subspace: 22 / 32
Training the subspace: 23 / 32
Training the subspace: 24 / 32
Training the subspace: 25 / 32
Training the subspace: 26 / 32
Training the subspace: 27 / 32
Training the subspace: 28 / 32
Training the subspace: 29 / 32
Training the subspace: 30 / 32
Training the subspace: 31 / 32
SIMD support: avx512
Encoding the subspace: 0 / 32
Encoding the subspace: 1 / 32
Encoding the subspace: 2 / 32
Encoding the subspace: 3 / 32
Encoding the subspace: 4 / 32
Encoding the subspace: 5 / 32
Encoding the subspace: 6 / 32
Encoding the subspace: 7 / 32
Encoding the subspace: 8 / 32
Encoding the subspace: 9 / 32
Encoding the subspace: 10 / 32
Encoding the subspace: 11 / 32
Encoding the subspace: 12 / 32
Encoding the subspace: 13 / 32
Encoding the subspace: 14 / 32
Encoding the subspace: 15 / 32
Encoding the subspace: 16 / 32
Encoding the subspace: 17 / 32
Encoding the subspace: 18 / 32
Encoding the subspace: 19 / 32
Encoding the subspace: 20 / 32
Encoding the subspace: 21 / 32
Encoding the subspace: 22 / 32
Encoding the subspace: 23 / 32
Encoding the subspace: 24 / 32
Encoding the subspace: 25 / 32
Encoding the subspace: 26 / 32
Encoding the subspace: 27 / 32
Encoding the subspace: 28 / 32
Encoding the subspace: 29 / 32
Encoding the subspace: 30 / 32
Encoding the subspace: 31 / 32
10000 new vectors are added.
Total number of codes is 10000
The number of vectors used for training of coarse centers: 10000
Start to run PQk-means
Iteration start: 0 / 5
find_nn finished. Error: 96393.6
find_nn_time,24
find_nn+update_center_time,37
Iteration start: 1 / 5
find_nn finished. Error: 66656.1
find_nn_time,8
find_nn+update_center_time,19
Iteration start: 2 / 5
find_nn finished. Error: 64716.5
find_nn_time,6
find_nn+update_center_time,18
Iteration start: 3 / 5
find_nn finished. Error: 64002.1
find_nn_time,7
find_nn+update_center_time,18
Iteration start: 4 / 5
find_nn finished. Error: 63645.9
find_nn_time,4
find_nn+update_center_time,4
Start to update posting lists
===== Threshold selection ====
ivf is faster than linear scan even if |S|<=128. This is a bit weird. Anyway let's set threshold as 128
ivf is faster than linear scan even if |S|<=128. This is a bit weird. Anyway let's set threshold as 128
ivf is faster than linear scan even if |S|<=128. This is a bit weird. Anyway let's set threshold as 128
ivf is faster than linear scan even if |S|<=128. This is a bit weird. Anyway let's set threshold as 128
ivf is faster than linear scan even if |S|<=128. This is a bit weird. Anyway let's set threshold as 128
L: [100, 200, 400, 800, 1600]
threshold: [128, 128, 128, 128, 128]
polyfit coeff: [-6.11495661e-17  1.28000000e+02]
resultant func:  
-6.115e-17 x + 128
rii get  616  postive res from  1000  results, recall@ 10 : 0.616
recall dist(10\% per bucket):  [10.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
