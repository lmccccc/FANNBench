Start time: 06:30
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: redcaps1m
N: 1000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_1_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_1_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64
ef_search: 30 
dim: 512
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.151s ] Loaded metadata, 1000000 attr's found
[ 0.151s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.163s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_1_1_100000_real.json
[ 0.166s ] Loaded 10000 redcaps1m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_1_1_100000_real_10.json
[ 0.177s ] Loaded ground truth, gt_size: 10
[ 0.177s ] Index Params -- d: 512, M: 40, N: 1000000, gamma: 25
--ACORN index created
acorn size: 598384000, memory: 2535.233MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 999918 nodes
level 1 : 24954 nodes
level 2 : 623 nodes
level 3 : 16 nodes
level 4 : 1 nodes
level 5 : 0 nodes
Total edge:1025512
Average degree per layer:170918.667
node size:1000000
Average degree:149.596
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2.450s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 30
selectivity: 1.000
[ 24.609s ] Query results (vector ids, then distances):
query 0 nn's (1250443791): 265404 (1530180402) 49228 (1595605317) 548160 (1606410873) 437670 (1596130852) 800767 (1597551450) 75346 (1564168304) 602879 (1548953318) 813377 (1544571766) 86846 (1500367075) 938509 (1522528411) 
     dis: 	0.771 0.828 0.836 0.858 0.863 0.879 0.898 0.898 0.903 0.904 
query 1 nn's (1609459076): 666880 (1555641433) 979250 (1523372340) 728340 (1587919683) 622447 (1532959985) 964028 (1579883899) 199154 (1601707637) 803332 (1530141155) 361663 (1607858914) 427146 (1514695882) 428754 (1560720094) 
     dis: 	0.101 0.101 0.101 0.103 0.106 0.106 0.106 0.106 0.106 0.107 
query 2 nn's (1250443791): 582384 (1582295732) 467742 (1609207957) 706700 (1606261780) 243553 (1568753382) 354715 (1540167683) 622798 (1556152887) 404702 (1538167950) 229394 (1527006058) 989632 (1570827777) 56081 (1524506922) 
     dis: 	0.396 0.397 0.398 0.398 0.399 0.403 0.403 0.404 0.407 0.409 
query 3 nn's (1609459076): 689368 (1563091635) 889987 (1593644784) 583699 (1511048352) 783586 (1584449301) 907599 (1562830155) 124464 (1588791594) 640717 (1593715105) 905275 (1491272214) 687871 (1584368476) 595884 (1603585196) 
     dis: 	0.403 0.403 0.405 0.409 0.446 0.449 0.455 0.459 0.460 0.462 
query 4 nn's (1250443791): 582698 (1557087889) 522469 (1606475445) 695669 (1587844268) 797013 (1605732191) 234795 (1600891554) 189529 (1600981496) 931553 (1570901224) 598411 (1595872318) 892178 (1586648068) 421184 (1600363229) 
     dis: 	0.260 0.260 0.269 0.273 0.274 0.281 0.284 0.286 0.288 0.289 
[ 24.609s ] *** Query time: 15.325
qps: 652.524
 *** acorn recall 
efs:30
acorn get 71223 postive res from 100000 results, recall@10:0.712
recall dist(10% per bucket): 0.175 0.008 0.009 0.013 0.015 0.021 0.033 0.056 0.100 0.194 0.375 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[24.609s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 15838943
ndis: 0
nreorder: 0
average distance computations per query: 1583.894
[ 24.609s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query redcaps1m 1000000 25 40 64 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_1_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_1_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64 30 512"
	User time (seconds): 22.42
	System time (seconds): 2.34
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:24.77
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3227880
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 817205
	Voluntary context switches: 1
	Involuntary context switches: 40
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:34
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: redcaps1m
N: 1000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64
ef_search: 30 
dim: 512
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.147s ] Loaded metadata, 1000000 attr's found
[ 0.147s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.159s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json
[ 0.162s ] Loaded 10000 redcaps1m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_10.json
[ 0.173s ] Loaded ground truth, gt_size: 10
[ 0.173s ] Index Params -- d: 512, M: 40, N: 1000000, gamma: 25
--ACORN index created
acorn size: 598384000, memory: 2535.233MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 999918 nodes
level 1 : 24954 nodes
level 2 : 623 nodes
level 3 : 16 nodes
level 4 : 1 nodes
level 5 : 0 nodes
Total edge:1025512
Average degree per layer:170918.667
node size:1000000
Average degree:149.596
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2.450s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 30
selectivity: 0.500
[ 67.376s ] Query results (vector ids, then distances):
query 0 nn's (1540574211): 297407 (1562582134) 75346 (1564168304) 813377 (1544571766) 77303 (1588455303) 422643 (1556978810) 13080 (1541731484) 36195 (1542321827) 317245 (1566794544) 745043 (1585143585) 301131 (1553274671) 
     dis: 	0.772 0.879 0.898 0.913 0.915 0.926 0.926 0.936 0.939 0.939 
query 1 nn's (1590004802): 741325 (1559616195) 666880 (1555641433) 979250 (1523372340) 622447 (1532959985) 803332 (1530141155) 427146 (1514695882) 428754 (1560720094) 110189 (1507487399) 139424 (1535633696) 284310 (1570817806) 
     dis: 	0.100 0.101 0.101 0.103 0.106 0.106 0.107 0.109 0.110 0.112 
query 2 nn's (1502815998): 582384 (1582295732) 243553 (1568753382) 989632 (1570827777) 111196 (1595607052) 654633 (1601080735) 566297 (1596130491) 734045 (1573436974) 763088 (1580442825) 796627 (1580425923) 763137 (1567791948) 
     dis: 	0.396 0.398 0.407 0.409 0.411 0.412 0.412 0.413 0.414 0.415 
query 3 nn's (1574739098): 889987 (1593644784) 783586 (1584449301) 124464 (1588791594) 640717 (1593715105) 687871 (1584368476) 595884 (1603585196) 889856 (1574977953) 306883 (1582504320) 110113 (1584365036) 456770 (1569878368) 
     dis: 	0.403 0.409 0.449 0.455 0.460 0.462 0.465 0.476 0.496 0.496 
query 4 nn's (1565134124): 582698 (1557087889) 46163 (1552605357) 279888 (1555515184) 700754 (1557101934) 754904 (1532757000) 68136 (1537086660) 556169 (1553542108) 231993 (1563749968) 54130 (1553866600) 60658 (1512331918) 
     dis: 	0.260 0.300 0.303 0.304 0.305 0.306 0.307 0.307 0.308 0.309 
[ 67.376s ] *** Query time: 15.811
qps: 632.469
 *** acorn recall 
efs:30
acorn get 79564 postive res from 100000 results, recall@10:0.796
recall dist(10% per bucket): 0.126 0.007 0.006 0.009 0.008 0.014 0.023 0.038 0.069 0.155 0.546 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[67.378s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 14292429
ndis: 0
nreorder: 0
average distance computations per query: 1429.243
[ 67.378s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query redcaps1m 1000000 25 40 64 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_6_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_6_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64 30 512"
	User time (seconds): 64.85
	System time (seconds): 2.71
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:07.57
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3227876
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 1
	Minor (reclaiming a frame) page faults: 880009
	Voluntary context switches: 1
	Involuntary context switches: 155
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:39
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: redcaps1m
N: 1000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64
ef_search: 30 
dim: 512
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.148s ] Loaded metadata, 1000000 attr's found
[ 0.148s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.159s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json
[ 0.162s ] Loaded 10000 redcaps1m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json
[ 0.173s ] Loaded ground truth, gt_size: 10
[ 0.173s ] Index Params -- d: 512, M: 40, N: 1000000, gamma: 25
--ACORN index created
acorn size: 598384000, memory: 2535.233MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 999918 nodes
level 1 : 24954 nodes
level 2 : 623 nodes
level 3 : 16 nodes
level 4 : 1 nodes
level 5 : 0 nodes
Total edge:1025512
Average degree per layer:170918.667
node size:1000000
Average degree:149.596
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2.389s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 30
selectivity: 0.100
[ 52.557s ] Query results (vector ids, then distances):
query 0 nn's (1582001887): 562528 (1586530455) 864174 (1586141206) 363324 (1588150617) 309200 (1583866074) 825029 (1587509747) 318225 (1582255095) 77303 (1588455303) 399187 (1587938124) 553713 (1584927669) 419559 (1588543049) 
     dis: 	0.641 0.743 0.814 0.854 0.888 0.905 0.913 0.920 0.922 0.922 
query 1 nn's (1589499026): 964018 (1566639637) 979295 (1567526425) 848169 (1567967943) 272839 (1567350368) 743973 (1565255174) 964128 (1566424023) 925657 (1569885810) 324349 (1565636095) 107066 (1564445038) 489550 (1561300577) 
     dis: 	0.113 0.115 0.115 0.119 0.120 0.122 0.123 0.123 0.126 0.127 
query 2 nn's (1560999281): 306439 (1575579764) 374226 (1576918189) 435452 (1574701387) 328089 (1574112193) 919763 (1580427352) 882709 (1573089021) 341373 (1582339286) 509068 (1582362871) 812326 (1580129904) 184796 (1580838071) 
     dis: 	0.238 0.263 0.278 0.280 0.284 0.288 0.297 0.300 0.301 0.303 
query 3 nn's (1570293538): 687871 (1584368476) 306883 (1582504320) 110113 (1584365036) 555783 (1582924247) 879049 (1580410467) 225830 (1582762176) 397607 (1576582831) 800827 (1581281066) 931871 (1577236835) 17746 (1578159083) 
     dis: 	0.460 0.476 0.496 0.517 0.517 0.531 0.533 0.538 0.546 0.547 
query 4 nn's (1572763542): 754904 (1532757000) 330129 (1525225883) 969773 (1527858141) 870723 (1530111079) 616623 (1529427583) 262276 (1518198483) 805996 (1530049195) 51681 (1535136336) 309894 (1532146088) 148545 (1518097309) 
     dis: 	0.305 0.325 0.328 0.332 0.332 0.333 0.335 0.335 0.340 0.345 
[ 52.557s ] *** Query time: 11.138
qps: 897.811
 *** acorn recall 
efs:30
acorn get 90185 postive res from 100000 results, recall@10:0.902
recall dist(10% per bucket): 0.051 0.003 0.002 0.003 0.004 0.007 0.008 0.022 0.052 0.142 0.705 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[52.558s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 9816361
ndis: 0
nreorder: 0
average distance computations per query: 981.636
[ 52.558s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query redcaps1m 1000000 25 40 64 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64 30 512"
	User time (seconds): 50.28
	System time (seconds): 2.46
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:52.75
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3227868
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 817201
	Voluntary context switches: 1
	Involuntary context switches: 76
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:45
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: redcaps1m
N: 1000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64
ef_search: 30 
dim: 512
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.146s ] Loaded metadata, 1000000 attr's found
[ 0.146s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.159s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json
[ 0.162s ] Loaded 10000 redcaps1m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json
[ 0.173s ] Loaded ground truth, gt_size: 10
[ 0.173s ] Index Params -- d: 512, M: 40, N: 1000000, gamma: 25
--ACORN index created
acorn size: 598384000, memory: 2535.233MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 999918 nodes
level 1 : 24954 nodes
level 2 : 623 nodes
level 3 : 16 nodes
level 4 : 1 nodes
level 5 : 0 nodes
Total edge:1025512
Average degree per layer:170918.667
node size:1000000
Average degree:149.596
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2.443s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 30
selectivity: 0.010
[ 41.837s ] Query results (vector ids, then distances):
query 0 nn's (1538594774): 403179 (1540068939) 832075 (1539306045) 648454 (1539400165) 326131 (1539534545) 118594 (1539257731) 186685 (1539544490) 992479 (1539422762) 890962 (1539116785) 895993 (1539507653) 98483 (1539990235) 
     dis: 	1.003 1.034 1.035 1.036 1.066 1.071 1.071 1.075 1.076 1.077 
query 1 nn's (1540118398): 927127 (1558717337) 733452 (1559175588) 464470 (1558400701) 939302 (1558567980) 971334 (1559186451) 955379 (1558478768) 746198 (1558997714) 88037 (1559127751) 782110 (1559118077) 659305 (1558315517) 
     dis: 	0.592 0.669 0.674 0.676 0.678 0.679 0.680 0.680 0.684 0.685 
query 2 nn's (1558313707): 582384 (1582295732) 655207 (1581722332) 743948 (1582200368) 213207 (1582318129) 941683 (1581872624) 129396 (1582425867) 170775 (1582409936) 938378 (1581968627) 52527 (1581710552) 340835 (1582508629) 
     dis: 	0.396 0.465 0.467 0.467 0.469 0.473 0.477 0.479 0.480 0.480 
query 3 nn's (1559317195): 769868 (1542487532) 493967 (1542294990) 953342 (1542471165) 136421 (1542307684) 175440 (1542245841) 972437 (1541427748) 385496 (1541953821) 762523 (1542714651) 742777 (1541363545) 470469 (1542471828) 
     dis: 	0.474 0.561 0.576 0.594 0.597 0.608 0.611 0.629 0.630 0.634 
query 4 nn's (1581675605): 929991 (1548794594) 843400 (1549019747) 556735 (1548803052) 359872 (1548277437) 924765 (1548418215) 855122 (1548705861) 802461 (1548697185) 62976 (1548022732) 488089 (1548395559) 213717 (1548537413) 
     dis: 	0.317 0.360 0.374 0.377 0.381 0.383 0.391 0.403 0.406 0.406 
[ 41.837s ] *** Query time: 7.613
qps: 1313.536
 *** acorn recall 
efs:30
acorn get 66479 postive res from 100000 results, recall@10:0.665
recall dist(10% per bucket): 0.175 0.017 0.017 0.017 0.026 0.036 0.050 0.076 0.120 0.190 0.276 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[41.838s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 2319241
ndis: 0
nreorder: 0
average distance computations per query: 231.924
[ 41.838s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query redcaps1m 1000000 25 40 64 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64 30 512"
	User time (seconds): 39.61
	System time (seconds): 2.39
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:42.01
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3227876
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 817201
	Voluntary context switches: 1
	Involuntary context switches: 83
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:50
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: redcaps1m
N: 1000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64
ef_search: 30 
dim: 512
metadata or vector loaded from json, size: 1000000
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.142s ] Loaded metadata, 1000000 attr's found
[ 0.142s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.155s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
metadata or vector loaded from json, size: 20000
loaded query attributes from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json
[ 0.158s ] Loaded 10000 redcaps1m queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json
[ 0.169s ] Loaded ground truth, gt_size: 10
[ 0.169s ] Index Params -- d: 512, M: 40, N: 1000000, gamma: 25
--ACORN index created
acorn size: 598384000, memory: 2535.233MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 999918 nodes
level 1 : 24954 nodes
level 2 : 623 nodes
level 3 : 16 nodes
level 4 : 1 nodes
level 5 : 0 nodes
Total edge:1025512
Average degree per layer:170918.667
node size:1000000
Average degree:149.596
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 2.472s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 30
selectivity: 0.001
[ 34.993s ] Query results (vector ids, then distances):
query 0 nn's (1538054874): 291056 (1538175426) 739909 (1538073461) 0 (1568768349) 681590 (1538188501) 1 (1587241519) 763582 (1538057631) 22831 (1538198281) 106108 (1538165652) 530354 (1538092692) 956771 (1538147067) 
     dis: 	1.210 1.253 1.253 1.254 1.274 1.279 1.279 1.280 1.301 1.334 
query 1 nn's (1538228285): 947217 (1507065090) 0 (1568768349) 142283 (1507211460) 403732 (1507083745) 482301 (1507017455) 519340 (1506948297) 2 (1603315169) 988562 (1506911852) 1 (1587241519) 810888 (1506981627) 
     dis: 	0.748 0.806 0.818 0.881 0.893 0.910 0.948 0.950 0.965 0.983 
query 2 nn's (1506909292): 0 (1568768349) 2 (1603315169) 1 (1587241519) 361047 (1552613267) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.748 0.865 0.913 1.063 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (1507230692): 0 (1568768349) 1 (1587241519) 837966 (1586965415) 650460 (1586991518) 2 (1603315169) 78632 (1587006878) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	1.025 1.180 1.210 1.316 1.324 1.379 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (1552519107): 1 (1587241519) 0 (1568768349) 2 (1603315169) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.784 0.997 1.039 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
[ 34.993s ] *** Query time: 1.837
qps: 5443.271
 *** acorn recall 
efs:30
acorn get 879 postive res from 100000 results, recall@10:0.009
recall dist(10% per bucket): 0.955 0.026 0.008 0.005 0.003 0.002 0.001 0.000 0.000 0.000 0.000 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[34.994s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 86733
ndis: 0
nreorder: 0
average distance computations per query: 8.673
[ 34.994s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query redcaps1m 1000000 25 40 64 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/acorn_kg/index/index_acorn_kg_sel_1_100000_real_M40_ga25_Mb64 30 512"
	User time (seconds): 32.71
	System time (seconds): 2.48
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:35.20
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 3227880
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 817203
	Voluntary context switches: 1
	Involuntary context switches: 38
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
