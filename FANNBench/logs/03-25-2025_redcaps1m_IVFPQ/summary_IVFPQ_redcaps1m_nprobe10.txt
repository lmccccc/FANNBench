Start time: 05:16
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.081s ] Loaded metadata, 1000000 attr's found
[ 0.081s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.094s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.127s ] Loaded 10000 redcaps1m queries
[ 0.199s ] Loaded ground truth, gt_size: 10
[ 0.199s ] Index Params -- d: 512, N: 1000000
terminate called after throwing an instance of 'faiss::FaissException'
  what():  Error in faiss::FileIOReader::FileIOReader(const char*) at /home/mocheng/code/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 for reading: No such file or directory
Command terminated by signal 6
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 0.09
	System time (seconds): 0.02
	Percent of CPU this job got: 2%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:04.37
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 34316
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 7766
	Voluntary context switches: 13
	Involuntary context switches: 2
	Swaps: 0
	File system inputs: 0
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:16
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.076s ] Loaded metadata, 1000000 attr's found
[ 0.076s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.090s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.126s ] Loaded 10000 redcaps1m queries
[ 0.185s ] Loaded ground truth, gt_size: 10
[ 0.185s ] Index Params -- d: 512, N: 1000000
terminate called after throwing an instance of 'faiss::FaissException'
  what():  Error in faiss::FileIOReader::FileIOReader(const char*) at /home/mocheng/code/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 for reading: No such file or directory
Command terminated by signal 6
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 0.08
	System time (seconds): 0.02
	Percent of CPU this job got: 1%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:06.09
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 36768
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 7739
	Voluntary context switches: 12
	Involuntary context switches: 2
	Swaps: 0
	File system inputs: 608
	File system outputs: 8
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:17
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.080s ] Loaded metadata, 1000000 attr's found
[ 0.080s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.092s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.117s ] Loaded 10000 redcaps1m queries
[ 0.149s ] Loaded ground truth, gt_size: 10
[ 0.149s ] Index Params -- d: 512, N: 1000000
terminate called after throwing an instance of 'faiss::FaissException'
  what():  Error in faiss::FileIOReader::FileIOReader(const char*) at /home/mocheng/code/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 for reading: No such file or directory
Command terminated by signal 6
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 0.08
	System time (seconds): 0.02
	Percent of CPU this job got: 2%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:05.07
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 36772
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 7740
	Voluntary context switches: 12
	Involuntary context switches: 1
	Swaps: 0
	File system inputs: 96
	File system outputs: 8
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 05:18
====================
START: running IVFPQ_INDEX_CONSTRUCTION, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 128
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
dim: 512
partition_size: 512
train file: /mnt/data/mocheng/dataset/redcaps1m/train.fvecs
loaded base attributes, size:1000000
[ 0.081s ] Loaded attributions, 1000000 found
[ 0.081s ] Index Params -- d: 512, N: 1000000
ncentroids: 4000
====================Vectors====================

[ 0.081s ] Loading database
[ 3.906s ] Loaded base vectors from file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
data loaded, with dim: 512, N=1000000
[ 3.907s ] Indexing database, size 1000000*512 from max 1000000
[ 3.907s ] Adding the vectors to the index
WARNING clustering 100000 points to 4000 centroids: please provide at least 156000 training points
train cost:0.373
index construction total cost:1734.865
[ 1734.865s ] Vectors added to  index
Index vectors added:1000000
====================Write Index================

[ 1739.205s ] Wrote ivbfpq index to file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
[1739.205 s] -----DONE-----
[ 1739.205s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_build redcaps1m 1000000 10 128 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 512 512 /mnt/data/mocheng/dataset/redcaps1m/train.fvecs"
	User time (seconds): 212880.73
	System time (seconds): 33.45
	Percent of CPU this job got: 12240%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 28:59.42
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 5027444
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 3270062
	Voluntary context switches: 1879876
	Involuntary context switches: 7792840
	Swaps: 0
	File system inputs: 4408744
	File system outputs: 1032720
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:01
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.081s ] Loaded metadata, 1000000 attr's found
[ 0.081s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.094s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.096s ] Loaded 10000 redcaps1m queries
[ 0.103s ] Loaded ground truth, gt_size: 10
[ 0.103s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.801s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.100
[ 34.057s ] Query results (vector ids, then distances):
query 0 nn's (1582001887, 1589499026): 562528 (1586530455) 363324 (1588150617) 309200 (1583866074) 318225 (1582255095) 399187 (1587938124) 373982 (1587320434) 44577 (1583002559) 965396 (1589114636) 243123 (1588045918) 440172 (1584059747) 
     dis: 	0.638 0.812 0.848 0.906 0.917 0.932 0.949 0.950 0.956 0.961 
query 1 nn's (1560999281, 1570293538): 964018 (1566639637) 979295 (1567526425) 848169 (1567967943) 661716 (1569475757) 272839 (1567350368) 743973 (1565255174) 226358 (1565225638) 964128 (1566424023) 925657 (1569885810) 324349 (1565636095) 
     dis: 	0.113 0.115 0.115 0.116 0.120 0.120 0.122 0.122 0.123 0.123 
query 2 nn's (1572763542, 1582585543): 306439 (1575579764) 435452 (1574701387) 800558 (1578206579) 919763 (1580427352) 341373 (1582339286) 136876 (1579879526) 509068 (1582362871) 812326 (1580129904) 184796 (1580838071) 304775 (1575151723) 
     dis: 	0.238 0.277 0.284 0.284 0.297 0.298 0.300 0.300 0.303 0.303 
query 3 nn's (1574977513, 1584382757): 306883 (1582504320) 110113 (1584365036) 555783 (1582924247) 879049 (1580410467) 225830 (1582762176) 397607 (1576582831) 800827 (1581281066) 931871 (1577236835) 17746 (1578159083) 694334 (1583158570) 
     dis: 	0.476 0.495 0.516 0.517 0.532 0.533 0.539 0.544 0.546 0.553 
query 4 nn's (1517035768, 1535603056): 754904 (1532757000) 969773 (1527858141) 51681 (1535136336) 148545 (1518097309) 569466 (1522175329) 440301 (1534385643) 464808 (1521378210) 101369 (1531669788) 923538 (1527525691) 4809 (1526640489) 
     dis: 	0.306 0.327 0.335 0.344 0.348 0.351 0.352 0.352 0.355 0.363 
[ 34.057s ] *** Query time: 24.743
qps: 404.152
 *** ivfpq recall 
ivfpq get 82498 postive res from 100000 results, recall@10:0.825
recall dist(10% per bucket): 0.001 0.003 0.010 0.018 0.032 0.051 0.073 0.097 0.135 0.208 0.372 
finished ivfpq index examples
[ 34.060s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_10_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_10_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 31.12
	System time (seconds): 3.09
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:34.22
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2603944
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 1249491
	Voluntary context switches: 1
	Involuntary context switches: 51
	Swaps: 0
	File system inputs: 0
	File system outputs: 16
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:08
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.075s ] Loaded metadata, 1000000 attr's found
[ 0.075s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.089s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.090s ] Loaded 10000 redcaps1m queries
[ 0.097s ] Loaded ground truth, gt_size: 10
[ 0.097s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.813s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.010
[ 28.884s ] Query results (vector ids, then distances):
query 0 nn's (1538594774, 1540118398): 105181 (1539349926) 80643 (1539819925) 90915 (1539863751) 75391 (1538671303) 933645 (1539570084) 276891 (1539273634) 765853 (1539654523) 870677 (1539260759) 417596 (1538975551) 944924 (1540070019) 
     dis: 	0.920 0.970 1.041 1.049 1.053 1.089 1.089 1.092 1.092 1.106 
query 1 nn's (1558313707, 1559317195): 634858 (1559095216) 747350 (1558405403) 328886 (1559221626) 878375 (1559157897) 840825 (1559253647) 433046 (1558315145) 977957 (1559149838) 348487 (1559253366) 619059 (1559307158) 894069 (1558990053) 
     dis: 	0.134 0.138 0.139 0.144 0.148 0.152 0.157 0.158 0.161 0.166 
query 2 nn's (1581675605, 1582524306): 341373 (1582339286) 509068 (1582362871) 459595 (1582500502) 838497 (1582143070) 426699 (1581810177) 781304 (1582459468) 378439 (1581820524) 878182 (1582491146) 776146 (1582065578) 884131 (1581883010) 
     dis: 	0.297 0.300 0.305 0.328 0.357 0.377 0.384 0.385 0.386 0.387 
query 3 nn's (1541361198, 1542915636): 769868 (1542487532) 493967 (1542294990) 136421 (1542307684) 385496 (1541953821) 706013 (1541385453) 123236 (1541964208) 111238 (1542231670) 114248 (1541618982) 180060 (1542136356) 250576 (1542724381) 
     dis: 	0.474 0.562 0.593 0.613 0.669 0.674 0.682 0.698 0.702 0.704 
query 4 nn's (1547965400, 1549164333): 929991 (1548794594) 855122 (1548705861) 802461 (1548697185) 488089 (1548395559) 741617 (1549149038) 356311 (1548857389) 649594 (1548344576) 946299 (1548080854) 383660 (1548352189) 148970 (1548196293) 
     dis: 	0.317 0.384 0.391 0.406 0.435 0.440 0.465 0.468 0.477 0.488 
[ 28.884s ] *** Query time: 20.172
qps: 495.744
 *** ivfpq recall 
ivfpq get 62677 postive res from 100000 results, recall@10:0.627
recall dist(10% per bucket): 0.007 0.022 0.048 0.080 0.103 0.117 0.130 0.138 0.127 0.119 0.108 
finished ivfpq index examples
[ 28.885s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_19_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_19_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 27.73
	System time (seconds): 1.30
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:29.04
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2604964
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 649912
	Voluntary context switches: 1
	Involuntary context switches: 40
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 06:16
====================
START: running TEST_IVFPQ, sift data --

dataset: redcaps1m
N: 1000000
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs
query file: /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
attr file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
qrange file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json
gt file: /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json
index file: /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512
nprobe: 10
dim: 512
loaded base attributes from:/mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json
[ 0.076s ] Loaded metadata, 1000000 attr's found
[ 0.076s ] Loading query vectors and attributes
query vecs data loaded, with dim: 512, nb=10000
[ 0.089s ] Loaded query vectors from /mnt/data/mocheng/dataset/redcaps1m/query.fvecs
[ 0.090s ] Loaded 10000 redcaps1m queries
[ 0.098s ] Loaded ground truth, gt_size: 10
[ 0.098s ] Index Params -- d: 512, N: 1000000
 load index size: 1000000
--Index created
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== IVFPQ INDEX ====================
[ 2.764s ] Searching the 10 nearest neighbors of 10000 vectors in the index
selectivity: 0.001
[ 26.938s ] Query results (vector ids, then distances):
query 0 nn's (1538054874, 1538228285): 7045 (1538194886) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.981 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 1 nn's (1506909292, 1507230692): 80546 (1507132298) 550738 (1507215860) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.179 0.307 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 2 nn's (1552519107, 1552626645): 150896 (1552595157) 618598 (1552524240) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.363 0.445 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 3 nn's (1586951418, 1587012565): 906513 (1586962259) 295882 (1586984659) 461437 (1586971752) 527950 (1586974843) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.668 0.753 0.856 0.874 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
query 4 nn's (1549236779, 1549369643): 965697 (1549315582) 96607 (1549301991) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) -1 (0) 
     dis: 	0.446 0.629 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 340282346638528859811704183484516925440.000 
[ 26.938s ] *** Query time: 18.941
qps: 527.956
 *** ivfpq recall 
ivfpq get 23171 postive res from 100000 results, recall@10:0.232
recall dist(10% per bucket): 0.121 0.236 0.246 0.179 0.111 0.060 0.029 0.011 0.005 0.002 0.000 
finished ivfpq index examples
[ 26.939s ] -----DONE-----
	Command being timed: "../faiss/build/demos/ivfpq_query redcaps1m 1000000 10 1 /mnt/data/mocheng/dataset/redcaps1m/image_embeddings.fvecs /mnt/data/mocheng/dataset/redcaps1m/query.fvecs /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/attr_sel_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/qrangesel_20_1_100000_real.json /mnt/data/mocheng/dataset/redcaps1m/label/sel_1_100000_real/sif_gt_sel_20_1_100000_real_10.json /mnt/data/mocheng/dataset/redcaps1m/ivfpq/index/index_ivfpq_sel_1_100000_real_512 10 512"
	User time (seconds): 25.82
	System time (seconds): 1.23
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:27.06
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 2604964
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 649913
	Voluntary context switches: 1
	Involuntary context switches: 29
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
