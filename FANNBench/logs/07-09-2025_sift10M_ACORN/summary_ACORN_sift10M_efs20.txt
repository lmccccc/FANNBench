Start time: 02:23
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 20000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 2.149s ] Loaded metadata, 10000000 attr's found
[ 2.149s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 2.152s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 40000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
[ 2.156s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
[ 2.167s ] Loaded ground truth, gt_size: 10
[ 2.167s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
terminate called after throwing an instance of 'faiss::FaissException'
  what():  Error in faiss::FileIOReader::FileIOReader(const char*) at /home/mocheng/code/ACORN/faiss/impl/io.cpp:67: Error: 'f' failed: could not open /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64 for reading: No such file or directory
Command terminated by signal 6
	Command being timed: "../ACORN/build/demos/acorn_query_arbi sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64 20 128"
	User time (seconds): 1.63
	System time (seconds): 0.54
	Percent of CPU this job got: 94%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:02.31
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 710188
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 3
	Minor (reclaiming a frame) page faults: 309514
	Voluntary context switches: 7
	Involuntary context switches: 5
	Swaps: 0
	File system inputs: 2864
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 02:25
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 20000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 2.154s ] Loaded metadata, 10000000 attr's found
[ 2.154s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 2.157s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 40000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
[ 2.161s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
[ 2.172s ] Loaded ground truth, gt_size: 10
[ 2.172s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 9999555 nodes
level 1 : 249955 nodes
level 2 : 6212 nodes
level 3 : 140 nodes
level 4 : 3 nodes
level 5 : 0 nodes
Total edge:10255865
Average degree per layer:1709310.833
node size:10000000
Average degree:149.631
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 12.622s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.359
[ 249.839s ] Query results (vector ids, then distances):
query 0 nn's (6): 5514922 (6) 6141318 (6) 5284494 (6) 4738758 (6) 7293718 (6) 4538400 (6) 2807602 (6) 1077702 (6) 8465570 (6) 8435256 (6) 
     dis: 	72798.000 73183.000 73728.000 74463.000 75573.000 76603.000 80454.000 80790.000 81280.000 81799.000 
query 1 nn's (6): 8449497 (36517) 4234271 (81802) 2253711 (96811) 1273419 (43620) 411491 (53036) 8349375 (29606) 9219153 (49751) 469965 (47796) 1909131 (43187) 3309105 (27377) 
     dis: 	32633.000 44439.000 45140.000 46522.000 46959.000 49997.000 50730.000 50753.000 51310.000 51760.000 
query 2 nn's (15386): 9710602 (6) 5055964 (6) 4588082 (6) 5637368 (6) 9554416 (6) 4279056 (6) 4154052 (6) 40266 (6) 8863268 (6) 8068558 (6) 
     dis: 	40495.000 42316.000 47637.000 51405.000 52237.000 52719.000 53029.000 53080.000 53225.000 53350.000 
query 3 nn's (98713): 4083199 (25769) 8410503 (46018) 7269483 (65893) 2965607 (50953) 3643741 (56342) 6917633 (54178) 2358683 (31286) 6411621 (41300) 3041965 (48814) 727241 (36944) 
     dis: 	3910.000 4817.000 4894.000 5013.000 5279.000 5626.000 5694.000 5998.000 6095.000 6237.000 
query 4 nn's (6): 5036980 (6) 4551510 (6) 8904886 (6) 2840566 (6) 9353798 (6) 2002058 (6) 6559886 (6) 6011480 (6) 1422386 (6) 102816 (6) 
     dis: 	94937.000 96528.000 99374.000 99749.000 100266.000 100847.000 101018.000 101519.000 105551.000 105791.000 
[ 249.839s ] *** Query time: 11.114
qps: 899.785
 *** acorn recall 
efs:20
acorn get 25299 postive res from 100000 results, recall@10:0.253
recall dist(10% per bucket): 0.104 0.185 0.226 0.211 0.153 0.086 0.029 0.006 0.001 0.000 0.000 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[249.840s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 13544367
ndis: 0
nreorder: 0
average distance computations per query: 1354.437
[ 249.840s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query_arbi sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64 20 128"
	User time (seconds): 239.27
	System time (seconds): 11.67
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 4:10.97
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 17037140
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 4544888
	Voluntary context switches: 1
	Involuntary context switches: 435
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
Start time: 04:36
====================
START: running TEST_ACORN for hnsw, sift data --

dataset: sift10M
N: 10000000
gamma: 25
M: 40
M_beta: 64
topk: 10
threads: 1
dataset file: /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs
query file: /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
attr file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
qrange file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
gt file: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
index file: /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64
ef_search: 20 
dim: 128
metadata or vector loaded from json, size: 20000000
loaded base attributes from:/mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json
[ 2.203s ] Loaded metadata, 20000000 attr's found
[ 2.203s ] Loading query vectors and attributes
query vecs data loaded, with dim: 128, nb=10000
[ 2.206s ] Loaded query vectors from /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs
metadata or vector loaded from json, size: 40000
loaded query attributes from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json
[ 2.210s ] Loaded 10000 sift10M queries
metadata or vector loaded from json, size: 100000
loaded gt from: /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json
[ 2.221s ] Loaded ground truth, gt_size: 10
[ 2.221s ] Index Params -- d: 128, M: 40, N: 10000000, gamma: 25
--ACORN index created
acorn size: 5985260000, memory: 10705.242MB
====================================
============ ACORN INDEX =============
====================================
METADATA VEC for number nodes per level
level 0 : 9999555 nodes
level 1 : 249955 nodes
level 2 : 6212 nodes
level 3 : 140 nodes
level 4 : 3 nodes
level 5 : 0 nodes
Total edge:10255865
Average degree per layer:1709310.833
node size:10000000
Average degree:149.631
==============================================
====================Search Results====================
==============================================
==============================================
====================Search====================
==============================================
==================== ACORN INDEX ====================
[ 12.613s ] Searching the 10 nearest neighbors of 10000 vectors in the index, efsearch 20
selectivity: 0.500
[ 565.030s ] Query results (vector ids, then distances):
query 0 nn's (6, 15386, 98713): 4738758 (6, 62037) 4538400 (6, 82045) 1020562 (6, 35855) 238649 (6, 89673) 9485971 (6, 68407) 7866119 (6, 74143) 7164607 (6, 98353) 8435256 (6, 19169) 2549151 (6, 55782) 5643020 (6, 54360) 
     dis: 	74463.000 76603.000 76767.000 77858.000 78877.000 79448.000 80358.000 81799.000 81827.000 82000.000 
query 1 nn's (6, 9087, 92417): 8449497 (6, 34983) 5552416 (6, 36365) 285986 (6, 75309) 4234271 (6, 67974) 2253711 (6, 37325) 4907604 (6, 25976) 1273419 (6, 33104) 7501440 (6, 14746) 1263214 (6, 88792) 9492445 (6, 12447) 
     dis: 	32633.000 42944.000 43778.000 44439.000 45140.000 46066.000 46522.000 46910.000 47608.000 48691.000 
query 2 nn's (6, 3328, 86670): 3900297 (6, 83217) 4588082 (6, 31606) 8667807 (6, 80757) 237844 (6, 23653) 5982237 (6, 65005) 4480383 (6, 54571) 3493381 (6, 18042) 2795236 (6, 16996) 5637368 (6, 73018) 7500565 (6, 8859) 
     dis: 	43033.000 47637.000 47988.000 49294.000 50144.000 50702.000 51043.000 51181.000 51405.000 51634.000 
query 3 nn's (6, 14596, 97918): 980813 (6, 71799) 1527942 (6, 63601) 2205832 (6, 88191) 4147780 (6, 81935) 6151275 (6, 35885) 8410503 (6, 21539) 7269483 (6, 65758) 3643741 (6, 16392) 1985932 (6, 29948) 5124856 (6, 21115) 
     dis: 	4296.000 4309.000 4343.000 4550.000 4602.000 4817.000 4894.000 5279.000 5371.000 5492.000 
query 4 nn's (6, 1537, 84881): 7091990 (6, 39499) 5493369 (6, 76459) 3389697 (6, 55907) 7724095 (6, 64271) 7423926 (6, 77977) 8630333 (6, 17180) 7455536 (6, 18226) 9493047 (6, 76865) 5126636 (6, 2816) 1127203 (6, 12198) 
     dis: 	77167.000 81626.000 84350.000 86698.000 87152.000 88437.000 90981.000 97659.000 98026.000 99086.000 
[ 565.030s ] *** Query time: 12.348
qps: 809.844
 *** acorn recall 
efs:20
acorn get 68822 postive res from 100000 results, recall@10:0.688
recall dist(10% per bucket): 0.025 0.025 0.034 0.052 0.070 0.081 0.100 0.122 0.135 0.157 0.200 
finished hybrid index examples
============= ACORN QUERY PROFILING STATS =============
[565.030s] Timing results for search of k=10 nearest neighbors of nq=10000 vectors in the index
n1: 10000
n2: 10000
n3 (number distance comps at level 0): 13680205
ndis: 0
nreorder: 0
average distance computations per query: 1368.021
[ 565.030s ] -----DONE-----
	Command being timed: "../ACORN/build/demos/acorn_query_arbi sift10M 10000000 25 40 64 10 1 /mnt/data/mocheng/dataset/sift10m/sift10m.fvecs /mnt/data/mocheng/dataset/sift10m/sift10m_query.fvecs /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/attr_sel_2_100000_random.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/qrangesel_6_2_100000_random_6.json /mnt/data/mocheng/dataset/sift10m/label/sel_2_100000_random/sif_gt_sel_6_2_100000_random_6_10.json /mnt/data/mocheng/dataset/sift10m/acorn/index/index_acorn_sel_2_100000_random_M40_ga25_Mb64 20 128"
	User time (seconds): 553.49
	System time (seconds): 12.62
	Percent of CPU this job got: 99%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 9:26.13
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 17037136
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 4544890
	Voluntary context switches: 1
	Involuntary context switches: 796
	Swaps: 0
	File system inputs: 0
	File system outputs: 24
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
